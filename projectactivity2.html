<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مجموعة الألعاب التعليمية</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            color: #4a5568;
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header h2 {
            color: #667eea;
            font-size: 1.5rem;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .header h3 {
            color: #764ba2;
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .header .course-info {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            display: inline-block;
            font-weight: 500;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .header .instruction {
            color: #4a5568;
            font-size: 1.2rem;
            font-weight: 400;
        }

        .games-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            border-color: #667eea;
        }

        .game-card:hover::before {
            transform: scaleX(1);
        }

        .game-content {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 10px;
            border-right: 4px solid #667eea;
        }

        .game-content.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);
        }

        .close-btn:hover {
            background: #ff5252;
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }

        .hint-area {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            display: none;
        }

        .hint-area.show {
            display: block;
            animation: bounceIn 0.5s ease;
        }

        .hint-area:hover {
            background: #fff8e1;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.3);
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .hint-tooltip {
            position: absolute;
            background: #333;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            top: -50px;
            right: 50%;
            transform: translateX(50%);
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
        }

        .hint-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            right: 50%;
            transform: translateX(50%);
            border: 5px solid transparent;
            border-top-color: #333;
        }

        .hint-area:hover .hint-tooltip {
            opacity: 1;
            top: -60px;
        }

        .reset-btn {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
            display: none;
        }

        .reset-btn.show {
            display: inline-block;
            animation: pulse 0.6s ease;
        }

        .reset-btn:hover {
            background: linear-gradient(45deg, #f57c00, #e65100);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.4);
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        .sparkle {
            position: relative;
            overflow: hidden;
        }

        .sparkle::before {
            content: '✨';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            animation: sparkle 2s infinite;
        }

        @keyframes sparkle {
            0%, 100% {
                opacity: 0;
                transform: scale(0.5) rotate(0deg);
            }
            50% {
                opacity: 1;
                transform: scale(1) rotate(180deg);
            }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-5px);
            }
            75% {
                transform: translateX(5px);
            }
        }

        .glow {
            animation: glow 1.5s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                box-shadow: 0 0 5px #667eea, 0 0 10px #667eea, 0 0 15px #667eea;
            }
            to {
                box-shadow: 0 0 10px #764ba2, 0 0 20px #764ba2, 0 0 30px #764ba2;
            }
        }

        /* تصميم شبكة الألعاب */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .game-card-preview {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            border: 3px solid transparent;
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .game-card-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .game-card-preview:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
            border-color: #667eea;
        }

        .game-card-preview:hover::before {
            transform: scaleX(1);
        }

        .game-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            display: block;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .game-card-preview h3 {
            color: #4a5568;
            font-size: 1.5rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .game-card-preview p {
            color: #666;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .game-features {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .feature {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .play-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            width: 100%;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* تصميم لعبة السباق */
        .teams-setup {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
        }

        .teams-setup h4 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .team-inputs {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }

        .team-inputs input {
            font-family: 'Tajawal', sans-serif;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .team-inputs input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .start-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .race-track {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f2ff 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid #667eea;
        }

        .track-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .track-header h4 {
            color: #4a5568;
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .current-stage {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            font-weight: 500;
        }

        .stages-track {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .stages-track::before {
            content: '';
            position: absolute;
            top: 30px;
            left: 10%;
            right: 10%;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 2px;
        }

        .stage {
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .stage-icon {
            background: white;
            border: 3px solid #667eea;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 10px;
            transition: all 0.3s ease;
        }

        .stage.active .stage-icon {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .stage-name {
            font-size: 0.9rem;
            font-weight: 500;
            color: #4a5568;
        }

        .teams-progress {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .team-track {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .team-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .team-name {
            font-weight: 500;
            color: #4a5568;
        }

        .team-score {
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .progress-bar {
            height: 40px;
            background: #e2e8f0;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .team-runner {
            position: absolute;
            left: 0%;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
            transition: left 0.8s ease;
            z-index: 2;
        }

        .question-area {
            margin-top: 20px;
        }

        .question-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-right: 4px solid #667eea;
        }

        .question-card h4 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .question-card p {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .answers {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .answer-btn {
            background: #f8f9ff;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: right;
        }

        .answer-btn:hover {
            border-color: #667eea;
            background: #e8f2ff;
            transform: translateX(-5px);
        }

        .answer-btn.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .answer-btn.wrong {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .question-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .new-question-btn, .reset-race-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reset-race-btn {
            background: linear-gradient(45deg, #ff9800, #f57c00);
        }

        .new-question-btn:hover, .reset-race-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .results-area {
            text-align: center;
            background: linear-gradient(135deg, #fff3cd, #d1ecf1);
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
        }

        .winner-announcement h3 {
            font-size: 2rem;
            color: #4a5568;
            margin-bottom: 15px;
        }

        .confetti {
            font-size: 2rem;
            margin: 20px 0;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .play-again-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-again-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* تصميم لعبة الكنز المعرفي */
        .treasure-setup {
            background: linear-gradient(135deg, #f8f9ff, #fff3cd);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #ffc107;
        }

        .treasure-header h4 {
            color: #4a5568;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .treasure-header p {
            color: #666;
            margin-bottom: 25px;
            font-size: 1.1rem;
        }

        .treasure-modes h5 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .treasure-mode-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 25px;
        }

        .treasure-mode-btn {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
            text-align: center;
            min-width: 200px;
            font-size: 1rem;
            font-weight: 500;
        }

        .treasure-mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .treasure-mode-btn span {
            display: block;
            font-size: 0.9rem;
            color: #666;
            margin-top: 8px;
            font-weight: 400;
        }

        .single-treasure:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .teams-treasure:hover {
            background: linear-gradient(135deg, #ffc107, #ff9800);
            color: white;
            border-color: #ffc107;
        }

        .treasure-teams-setup {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .treasure-teams-setup h5 {
            color: #4a5568;
            margin-bottom: 15px;
        }

        .treasure-teams-input {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .treasure-teams-input input {
            font-family: 'Tajawal', sans-serif;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .treasure-teams-input input:focus {
            outline: none;
            border-color: #ffc107;
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.2);
        }

        .start-treasure-btn {
            background: linear-gradient(45deg, #ffc107, #ff9800);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.3);
        }

        .start-treasure-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 193, 7, 0.4);
        }

        .treasure-dashboard {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .treasure-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .treasure-info h4 {
            margin: 0;
            font-size: 1.4rem;
        }

        .treasure-timer {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 1.1rem;
        }

        .treasure-teams-status {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 15px;
        }

        .treasure-team-status {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 10px;
        }

        .treasure-team-name {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .treasure-team-progress {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .treasure-progress {
            text-align: center;
        }

        .progress-label {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .treasure-progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 30px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .treasure-progress-fill {
            background: linear-gradient(90deg, #ffc107, #ff9800);
            height: 100%;
            width: 0%;
            border-radius: 15px;
            transition: width 0.5s ease;
        }

        .treasure-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
        }

        .scattered-cards-area {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px dashed #667eea;
        }

        .scattered-cards-area h4 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 20px;
        }

        .scattered-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            min-height: 120px;
            padding: 20px;
        }

        .treasure-card {
            background: linear-gradient(135deg, #fff, #f8f9ff);
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 15px 20px;
            cursor: grab;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            color: #4a5568;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
            user-select: none;
            position: relative;
        }

        .treasure-card:hover {
            transform: translateY(-5px) rotate(2deg);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            border-color: #ffc107;
        }

        .treasure-card:active {
            cursor: grabbing;
            transform: scale(1.05);
        }

        .treasure-card.dragging {
            opacity: 0.7;
            transform: rotate(5deg);
            z-index: 1000;
        }

        .sorting-area {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .sorting-area h4 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 20px;
        }

        .drop-zones {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .drop-zone {
            background: #f8f9ff;
            border: 3px dashed #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            min-width: 150px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            text-align: center;
        }

        .drop-zone.drag-over {
            border-color: #ffc107;
            background: #fff3cd;
            transform: scale(1.05);
        }

        .drop-zone.filled {
            border-color: #28a745;
            background: #d4edda;
        }

        .drop-zone.correct {
            border-color: #28a745;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            animation: correctPulse 0.6s ease;
        }

        .drop-zone.wrong {
            border-color: #dc3545;
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            animation: wrongShake 0.5s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .drop-zone-label {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .treasure-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .check-treasure-btn, .shuffle-btn, .reset-treasure-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .shuffle-btn {
            background: linear-gradient(45deg, #ffc107, #ff9800);
        }

        .reset-treasure-btn {
            background: linear-gradient(45deg, #dc3545, #c82333);
        }

        .check-treasure-btn:hover, .shuffle-btn:hover, .reset-treasure-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .treasure-results {
            background: linear-gradient(135deg, #fff3cd, #d1ecf1);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 3px solid #ffc107;
        }

        .treasure-celebration h3 {
            color: #4a5568;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .treasure-chest {
            font-size: 3rem;
            margin: 20px 0;
            animation: treasureBounce 1s infinite;
        }

        @keyframes treasureBounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.1); }
        }

        .treasure-final-time {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            font-size: 1.2rem;
            font-weight: 500;
            color: #4a5568;
        }

        .treasure-ranking {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .treasure-ranking h5 {
            color: #4a5568;
            margin-bottom: 15px;
        }

        .ranking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .ranking-item:last-child {
            border-bottom: none;
        }

        .ranking-position {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .ranking-position.first {
            color: #ffc107;
        }

        .ranking-position.second {
            color: #6c757d;
        }

        .ranking-position.third {
            color: #cd7f32;
        }

        .ranking-team {
            font-weight: 500;
            color: #4a5568;
        }

        .ranking-time {
            font-size: 1.1rem;
            color: #667eea;
            font-weight: 500;
        }

        .new-treasure-btn {
            background: linear-gradient(45deg, #ffc107, #ff9800);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .new-treasure-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 193, 7, 0.4);
        }

        .treasure-hints {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .hint-card {
            color: #856404;
            font-size: 1rem;
            text-align: center;
        }

        /* تصميم لعبة التحدي السريع */
        .challenge-setup {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
        }

        .setup-header h4 {
            color: #4a5568;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .setup-header p {
            color: #666;
            margin-bottom: 25px;
        }

        .game-modes h5 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .mode-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 25px;
        }

        .mode-btn {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
            text-align: center;
            min-width: 200px;
        }

        .mode-btn:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
        }

        .mode-btn span {
            display: block;
            font-size: 0.9rem;
            color: #666;
            margin-top: 8px;
        }

        .single-mode:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .team-mode:hover {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .team-setup-challenge {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .team-setup-challenge h5 {
            color: #4a5568;
            margin-bottom: 15px;
        }

        .teams-input {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .teams-input input {
            flex: 1;
            font-family: 'Tajawal', sans-serif;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .teams-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .start-challenge-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-challenge-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .scoreboard {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .score-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .score-header h4 {
            margin: 0;
            font-size: 1.4rem;
        }

        .timer {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 1.1rem;
        }

        .timer.warning {
            background: #ff6b6b;
            animation: pulse 1s infinite;
        }

        .scores-display {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 15px;
        }

        .player-score {
            text-align: center;
        }

        .player-name {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .score-value {
            font-size: 2rem;
            font-weight: 700;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 10px 15px;
            display: inline-block;
            min-width: 60px;
        }

        .game-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 0.9rem;
        }

        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 15px;
        }

        .question-challenge-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-category {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .question-difficulty {
            background: #28a745;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .question-difficulty.hard {
            background: #dc3545;
        }

        .question-difficulty.easy {
            background: #ffc107;
            color: #333;
        }

        .question-content h4 {
            color: #4a5568;
            font-size: 1.3rem;
            line-height: 1.6;
            margin-bottom: 20px;
            text-align: center;
        }

        .answers-challenge {
            display: grid;
            gap: 12px;
            margin-bottom: 20px;
        }

        .answer-challenge-btn {
            background: #f8f9ff;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px 20px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: right;
            position: relative;
        }

        .answer-challenge-btn:hover {
            border-color: #667eea;
            background: #e8f2ff;
            transform: translateX(-5px);
        }

        .answer-challenge-btn.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .answer-challenge-btn.wrong {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .answer-challenge-btn.true-false {
            font-size: 1.2rem;
            font-weight: 500;
            text-align: center;
        }

        .answer-challenge-btn.true-false.true {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
        }

        .answer-challenge-btn.true-false.false {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
        }

        .question-footer {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .next-question-btn, .skip-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .skip-btn {
            background: linear-gradient(45deg, #ffc107, #ff9800);
        }

        .next-question-btn:hover, .skip-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .challenge-results {
            background: linear-gradient(135deg, #fff3cd, #d1ecf1);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
        }

        .results-content h3 {
            color: #4a5568;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .final-scores {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .final-score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .final-score-item:last-child {
            border-bottom: none;
        }

        .final-score-name {
            font-weight: 500;
            color: #4a5568;
        }

        .final-score-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
        }

        .performance-analysis {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: right;
        }

        .performance-analysis h5 {
            color: #4a5568;
            margin-bottom: 15px;
        }

        .performance-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .performance-stat {
            text-align: center;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
        }

        .performance-stat .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            display: block;
        }

        .performance-stat .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        .results-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .restart-btn, .review-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .review-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .restart-btn:hover, .review-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .review-area {
            background: white;
            border-radius: 15px;
            padding: 25px;
            max-height: 400px;
            overflow-y: auto;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .review-header h4 {
            color: #4a5568;
            margin: 0;
        }

        .close-review-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-review-btn:hover {
            background: #ff5252;
            transform: scale(1.05);
        }

        .review-item {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-right: 4px solid #667eea;
        }

        .review-item.correct {
            border-right-color: #28a745;
            background: #d4edda;
        }

        .review-item.wrong {
            border-right-color: #dc3545;
            background: #f8d7da;
        }

        .review-question {
            font-weight: 500;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .review-answer {
            font-size: 0.9rem;
            color: #666;
        }

        .review-answer.user {
            color: #667eea;
            font-weight: 500;
        }

        .review-answer.correct {
            color: #28a745;
            font-weight: 500;
        }

        /* تأثيرات إضافية للكنز المعرفي */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        /* تصميم لعبة بناء المشروع */
        .builder-setup {
            background: linear-gradient(135deg, #f8f9ff, #e8f5e8);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #28a745;
        }

        .builder-header h4 {
            color: #4a5568;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .builder-header p {
            color: #666;
            margin-bottom: 25px;
            font-size: 1.1rem;
        }

        .builder-modes h5 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .builder-mode-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 25px;
        }

        .builder-mode-btn {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
            text-align: center;
            min-width: 200px;
            font-size: 1rem;
            font-weight: 500;
        }

        .builder-mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .builder-mode-btn span {
            display: block;
            font-size: 0.9rem;
            color: #666;
            margin-top: 8px;
            font-weight: 400;
        }

        .single-builder:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .teams-builder:hover {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border-color: #28a745;
        }

        .builder-teams-setup {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .builder-teams-setup h5 {
            color: #4a5568;
            margin-bottom: 15px;
        }

        .builder-teams-input {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .builder-teams-input input {
            font-family: 'Tajawal', sans-serif;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .builder-teams-input input:focus {
            outline: none;
            border-color: #28a745;
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.2);
        }

        .start-builder-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .start-builder-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .builder-dashboard {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .builder-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .builder-info h4 {
            margin: 0;
            font-size: 1.4rem;
        }

        .builder-timer {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 1.1rem;
        }

        .builder-teams-status {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 15px;
        }

        .builder-team-status {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 10px;
        }

        .builder-team-name {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .builder-team-progress {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .builder-progress {
            text-align: center;
        }

        .builder-progress-label {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .builder-progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 30px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .builder-progress-fill {
            background: linear-gradient(90deg, #ffc107, #ff9800);
            height: 100%;
            width: 0%;
            border-radius: 15px;
            transition: width 0.5s ease;
        }

        .builder-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
        }

        .components-area {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px dashed #28a745;
        }

        .components-area h4 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 20px;
        }

        .project-components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .project-component {
            background: linear-gradient(135deg, #fff, #f8f9ff);
            border: 3px solid #28a745;
            border-radius: 15px;
            padding: 20px;
            cursor: grab;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
            text-align: center;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.2);
            user-select: none;
            position: relative;
        }

        .project-component:hover {
            transform: translateY(-5px) rotate(2deg);
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);
            border-color: #ffc107;
        }

        .project-component:active {
            cursor: grabbing;
            transform: scale(1.05);
        }

        .project-component.dragging {
            opacity: 0.7;
            transform: rotate(5deg);
            z-index: 1000;
        }

        .project-component.selected {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-color: #28a745;
            transform: scale(1.05);
        }

        .component-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .component-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
        }

        .component-description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        .building-area {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .building-area h4 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 20px;
        }

        .project-foundation {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border: 3px dashed #28a745;
            border-radius: 20px;
            padding: 30px;
            min-height: 300px;
            position: relative;
            margin-bottom: 25px;
        }

        .foundation-layers {
            display: flex;
            flex-direction: column;
            gap: 15px;
            height: 100%;
        }

        .foundation-layer {
            background: rgba(255, 255, 255, 0.8);
            border: 2px dashed #28a745;
            border-radius: 15px;
            padding: 20px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .foundation-layer.drag-over {
            border-color: #ffc107;
            background: #fff3cd;
            transform: scale(1.02);
        }

        .foundation-layer.filled {
            border-color: #28a745;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
        }

        .foundation-layer.correct {
            border-color: #28a745;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            animation: correctPulse 0.6s ease;
        }

        .foundation-layer.wrong {
            border-color: #dc3545;
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            animation: wrongShake 0.5s ease;
        }

        .layer-label {
            position: absolute;
            top: -10px;
            right: 15px;
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .builder-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .check-build-btn, .shuffle-components-btn, .reset-builder-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .shuffle-components-btn {
            background: linear-gradient(45deg, #ffc107, #ff9800);
        }

        .reset-builder-btn {
            background: linear-gradient(45deg, #dc3545, #c82333);
        }

        .check-build-btn:hover, .shuffle-components-btn:hover, .reset-builder-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .builder-results {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 3px solid #28a745;
        }

        .builder-celebration h3 {
            color: #4a5568;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .project-building {
            font-size: 3rem;
            margin: 20px 0;
            animation: buildingBounce 1s infinite;
        }

        @keyframes buildingBounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.1); }
        }

        .builder-final-time {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            font-size: 1.2rem;
            font-weight: 500;
            color: #4a5568;
        }

        .builder-ranking {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .builder-ranking h5 {
            color: #4a5568;
            margin-bottom: 15px;
        }

        .new-builder-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .new-builder-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .builder-hints {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .builder-hint-card {
            color: #155724;
            font-size: 1rem;
            text-align: center;
        }

        /* تصميم متجاوب للكنز المعرفي */
        @media (max-width: 768px) {
            .treasure-mode-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .treasure-mode-btn {
                min-width: auto;
            }

            .treasure-teams-input {
                gap: 12px;
            }

            .treasure-teams-status {
                flex-direction: column;
                gap: 15px;
            }

            .scattered-cards {
                gap: 10px;
                padding: 15px;
            }

            .treasure-card {
                font-size: 0.9rem;
                padding: 12px 15px;
            }

            .drop-zones {
                flex-direction: column;
                gap: 15px;
            }

            .drop-zone {
                min-width: auto;
                width: 100%;
            }

            .treasure-controls {
                flex-direction: column;
                gap: 10px;
            }

            .treasure-controls button {
                width: 100%;
            }

            .treasure-chest {
                font-size: 2rem;
            }
        }

        /* تصميم متجاوب لبناء المشروع */
        @media (max-width: 768px) {
            .builder-mode-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .builder-mode-btn {
                min-width: auto;
            }

            .builder-teams-input {
                gap: 12px;
            }

            .builder-teams-status {
                flex-direction: column;
                gap: 15px;
            }

            .project-components {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .project-component {
                font-size: 0.9rem;
                padding: 15px;
            }

            .foundation-layers {
                gap: 10px;
            }

            .foundation-layer {
                min-height: 60px;
                padding: 15px;
            }

            .builder-controls {
                flex-direction: column;
                gap: 10px;
            }

            .builder-controls button {
                width: 100%;
            }

            .project-building {
                font-size: 2rem;
            }
        }

        /* تصميم لعبة الأدوار */
        .roleplay-setup {
            background: linear-gradient(135deg, #f8f9ff, #fff0f5);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #e91e63;
        }

        .roleplay-header h4 {
            color: #4a5568;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .roleplay-header p {
            color: #666;
            margin-bottom: 25px;
            font-size: 1.1rem;
        }

        .roleplay-modes h5 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .roleplay-mode-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 25px;
        }

        .roleplay-mode-btn {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
            text-align: center;
            min-width: 200px;
            font-size: 1rem;
            font-weight: 500;
        }

        .roleplay-mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .roleplay-mode-btn span {
            display: block;
            font-size: 0.9rem;
            color: #666;
            margin-top: 8px;
            font-weight: 400;
        }

        .single-roleplay:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .teams-roleplay:hover {
            background: linear-gradient(135deg, #e91e63, #ad1457);
            color: white;
            border-color: #e91e63;
        }

        .roleplay-teams-setup {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .roleplay-teams-setup h5 {
            color: #4a5568;
            margin-bottom: 15px;
        }

        .roleplay-teams-input {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .roleplay-teams-input input {
            font-family: 'Tajawal', sans-serif;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .roleplay-teams-input input:focus {
            outline: none;
            border-color: #e91e63;
            box-shadow: 0 0 10px rgba(233, 30, 99, 0.2);
        }

        .start-roleplay-btn {
            background: linear-gradient(45deg, #e91e63, #ad1457);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(233, 30, 99, 0.3);
        }

        .start-roleplay-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(233, 30, 99, 0.4);
        }

        .roleplay-dashboard {
            background: linear-gradient(135deg, #e91e63, #ad1457);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .roleplay-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .roleplay-info h4 {
            margin: 0;
            font-size: 1.4rem;
        }

        .roleplay-round {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 1.1rem;
        }

        .roleplay-teams-status {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 15px;
        }

        .roleplay-team-status {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 10px;
        }

        .roleplay-team-name {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .roleplay-team-score {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .scenario-area {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .scenario-title {
            color: #4a5568;
            font-size: 1.4rem;
            margin: 0;
        }

        .scenario-category {
            background: #e91e63;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .scenario-content {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            border-right: 4px solid #e91e63;
        }

        .scenario-description {
            color: #4a5568;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .scenario-details {
            background: rgba(233, 30, 99, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .scenario-details h6 {
            color: #e91e63;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .scenario-details ul {
            margin: 0;
            padding-right: 20px;
            color: #666;
        }

        .scenario-details li {
            margin-bottom: 5px;
        }

        .scenario-challenge {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .scenario-challenge h6 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .scenario-challenge p {
            color: #856404;
            margin: 0;
            font-weight: 500;
        }

        .teams-presentation {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px dashed #e91e63;
        }

        .teams-presentation h4 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 20px;
        }

        .presentation-slots {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .presentation-slot {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .presentation-slot.active {
            border-color: #e91e63;
            transform: scale(1.02);
            box-shadow: 0 5px 20px rgba(233, 30, 99, 0.2);
        }

        .slot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .team-presenter {
            font-size: 1.2rem;
            font-weight: 600;
            color: #4a5568;
        }

        .presentation-timer {
            background: #e91e63;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .presentation-content {
            background: #f8f9ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            min-height: 100px;
        }

        .presentation-textarea {
            width: 100%;
            min-height: 80px;
            border: none;
            background: transparent;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            color: #4a5568;
            resize: vertical;
            outline: none;
        }

        .presentation-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .start-presentation-btn, .finish-presentation-btn {
            background: linear-gradient(45deg, #e91e63, #ad1457);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .finish-presentation-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .start-presentation-btn:hover, .finish-presentation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .voting-area {
            background: linear-gradient(135deg, #fff3cd, #d1ecf1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 3px solid #ffc107;
        }

        .voting-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .voting-header h4 {
            color: #4a5568;
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .voting-instructions {
            color: #666;
            font-size: 1rem;
            margin-bottom: 20px;
        }

        .voting-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }

        .voting-option {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .voting-option:hover {
            border-color: #ffc107;
            transform: translateX(-5px);
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.2);
        }

        .voting-option.selected {
            border-color: #ffc107;
            background: #fff3cd;
        }

        .option-team {
            font-weight: 500;
            color: #4a5568;
            font-size: 1.1rem;
        }

        .option-votes {
            background: #ffc107;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 500;
            min-width: 40px;
            text-align: center;
        }

        .voting-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .cast-vote-btn, .show-results-btn {
            background: linear-gradient(45deg, #ffc107, #ff9800);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .show-results-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .cast-vote-btn:hover, .show-results-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .roleplay-results {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 3px solid #28a745;
        }

        .roleplay-celebration h3 {
            color: #4a5568;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .winner-podium {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .podium-place {
            text-align: center;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            min-width: 150px;
        }

        .podium-place.first {
            background: linear-gradient(135deg, #ffc107, #ff9800);
            color: white;
            transform: scale(1.1);
        }

        .podium-place.second {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
        }

        .podium-place.third {
            background: linear-gradient(135deg, #cd7f32, #a0522d);
            color: white;
        }

        .podium-position {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .podium-team {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .podium-votes {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .scenario-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .new-scenario-btn, .reset-roleplay-btn {
            background: linear-gradient(45deg, #e91e63, #ad1457);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .reset-roleplay-btn {
            background: linear-gradient(45deg, #dc3545, #c82333);
        }

        .new-scenario-btn:hover, .reset-roleplay-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .roleplay-tips {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .roleplay-tip-card {
            color: #155724;
            font-size: 1rem;
            text-align: center;
        }

        /* تصميم متجاوب للعبة الأدوار */
        @media (max-width: 768px) {
            .roleplay-mode-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .roleplay-mode-btn {
                min-width: auto;
            }

            .roleplay-teams-input {
                gap: 12px;
            }

            .roleplay-teams-status {
                flex-direction: column;
                gap: 15px;
            }

            .scenario-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .presentation-slots {
                gap: 15px;
            }

            .slot-header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .presentation-controls {
                flex-direction: column;
                gap: 10px;
            }

            .presentation-controls button {
                width: 100%;
            }

            .voting-options {
                gap: 12px;
            }

            .voting-option {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .voting-controls {
                flex-direction: column;
                gap: 10px;
            }

            .voting-controls button {
                width: 100%;
            }

            .winner-podium {
                flex-direction: column;
                gap: 15px;
            }

            .podium-place.first {
                transform: none;
            }

            .scenario-controls {
                flex-direction: column;
                gap: 10px;
            }

            .scenario-controls button {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .header h2 {
                font-size: 1.3rem;
            }
            
            .header h3 {
                font-size: 1.1rem;
            }

            .games-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .game-card-preview {
                padding: 25px;
            }

            .game-icon {
                font-size: 3rem;
            }

            .game-features {
                gap: 8px;
            }

            .feature {
                font-size: 0.8rem;
                padding: 5px 10px;
            }

            .stages-track {
                flex-wrap: wrap;
                gap: 15px;
            }

            .stage {
                flex: 1;
                min-width: 80px;
            }

            .teams-progress {
                gap: 15px;
            }

            .question-controls {
                flex-direction: column;
            }

            .mode-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .mode-btn {
                min-width: auto;
            }

            .teams-input {
                flex-direction: column;
            }

            .scores-display {
                flex-direction: column;
                gap: 15px;
            }

            .game-stats {
                flex-direction: column;
                gap: 10px;
            }

            .results-actions {
                flex-direction: column;
            }

            .performance-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header sparkle">
            <h1>مجموعة الألعاب التعليمية</h1>
            <h2>أنشطة وألعاب تفاعلية صفية لتعلم التخطيط لأساسيات المشروع 2</h2>
            <h3>ألعاب تفاعلية لتعلم التقنية الرقمية وإدارة المشاريع</h3>
            
            <div class="course-info">
                🎓 للمرحلة الثانوية - مقرر تقنية رقمية 3
            </div>
            
            <p class="instruction">اختر اللعبة التي تريد تجربتها من القائمة أدناه</p>
        </div>

        <div class="games-grid" id="gamesGrid">
            <div class="game-card-preview" onclick="openGame('race-game')">
                <div class="game-icon">🏁</div>
                <h3>سباق مراحل المشروع</h3>
                <p>سباق تفاعلي بين الفرق عبر مراحل المشروع الخمس مع أسئلة تحدي</p>
                <div class="game-features">
                    <span class="feature">👥 3 فرق</span>
                    <span class="feature">📋 أسئلة متدرجة</span>
                    <span class="feature">🏆 منافسة</span>
                </div>
                <button class="play-btn">🚀 ابدأ اللعب</button>
            </div>

            <div class="game-card-preview" onclick="openGame('quick-challenge')">
                <div class="game-icon">⚡</div>
                <h3>التحدي السريع</h3>
                <p>أسئلة سريعة عن إدارة المشاريع مع عداد زمني وتحليل الأداء</p>
                <div class="game-features">
                    <span class="feature">⏱️ 30 ثانية</span>
                    <span class="feature">❓ 20 سؤال</span>
                    <span class="feature">📊 تحليل الأداء</span>
                </div>
                <button class="play-btn">⚡ ابدأ التحدي</button>
            </div>

            <div class="game-card-preview" onclick="openGame('treasure-hunt')">
                <div class="game-icon">🏴‍☠️</div>
                <h3>الكنز المعرفي</h3>
                <p>اكتشف كنز إدارة المشاريع بترتيب مراحل دورة الحياة بأسرع وقت ممكن</p>
                <div class="game-features">
                    <span class="feature">🎯 ترتيب البطاقات</span>
                    <span class="feature">⏱️ سباق زمني</span>
                    <span class="feature">🏆 منافسة الفرق</span>
                </div>
                <button class="play-btn">🏴‍☠️ ابحث عن الكنز</button>
            </div>

            <div class="game-card-preview" onclick="openGame('project-builder')">
                <div class="game-icon">🏗️</div>
                <h3>بناء المشروع</h3>
                <p>اختر وركب قطع المشروع الافتراضية لبناء مشروع ناجح ومتكامل</p>
                <div class="game-features">
                    <span class="feature">🧩 7 قطع أساسية</span>
                    <span class="feature">🏗️ بناء تفاعلي</span>
                    <span class="feature">🏆 سباق الفرق</span>
                </div>
                <button class="play-btn">🏗️ ابدأ البناء</button>
            </div>

            <div class="game-card-preview" onclick="openGame('role-play')">
                <div class="game-icon">🎭</div>
                <h3>لعبة الأدوار</h3>
                <p>تمثيل أدوار مديري المشاريع في سيناريوهات واقعية مع التصويت للحل الأفضل</p>
                <div class="game-features">
                    <span class="feature">🎬 سيناريوهات واقعية</span>
                    <span class="feature">👥 تمثيل الأدوار</span>
                    <span class="feature">🗳️ تصويت تفاعلي</span>
                </div>
                <button class="play-btn">🎭 ابدأ التمثيل</button>
            </div>
        </div>

        <div class="games-container" id="gamesContainer" style="display: none;">
            <!-- لعبة سباق مراحل المشروع -->
            <div class="game-card" id="race-game" style="display: none;">
                <button class="close-btn" onclick="closeGame('race-game')">×</button>
                <h3>🏁 سباق مراحل المشروع</h3>
                <div class="game-content active">
                    
                    <!-- إعداد المجموعات -->
                    <div class="teams-setup" id="teamsSetup">
                        <h4>إعداد المجموعات المتنافسة</h4>
                        <div class="team-inputs">
                            <input type="text" id="team1Name" placeholder="اسم المجموعة الأولى" value="المجموعة الأولى">
                            <input type="text" id="team2Name" placeholder="اسم المجموعة الثانية" value="المجموعة الثانية">
                            <input type="text" id="team3Name" placeholder="اسم المجموعة الثالثة" value="المجموعة الثالثة">
                        </div>
                        <button onclick="startRace()" class="start-btn">🚀 بدء السباق</button>
                    </div>

                    <!-- منطقة السباق -->
                    <div class="race-area" id="raceArea" style="display: none;">
                        
                        <!-- مسار السباق -->
                        <div class="race-track">
                            <div class="track-header">
                                <h4>🏁 مسار سباق مراحل المشروع</h4>
                                <div class="current-stage" id="currentStage">المرحلة الحالية: البدء</div>
                            </div>
                            
                            <!-- محطات المراحل -->
                            <div class="stages-track">
                                <div class="stage" data-stage="0">
                                    <div class="stage-icon">🚀</div>
                                    <div class="stage-name">البدء</div>
                                </div>
                                <div class="stage" data-stage="1">
                                    <div class="stage-icon">📋</div>
                                    <div class="stage-name">التخطيط</div>
                                </div>
                                <div class="stage" data-stage="2">
                                    <div class="stage-icon">⚙️</div>
                                    <div class="stage-name">التنفيذ</div>
                                </div>
                                <div class="stage" data-stage="3">
                                    <div class="stage-icon">📊</div>
                                    <div class="stage-name">المراقبة والتحكم</div>
                                </div>
                                <div class="stage" data-stage="4">
                                    <div class="stage-icon">🏆</div>
                                    <div class="stage-name">الإنهاء</div>
                                </div>
                            </div>

                            <!-- شريط تقدم المجموعات -->
                            <div class="teams-progress">
                                <div class="team-track" id="team1Track">
                                    <div class="team-info">
                                        <span class="team-name" id="team1Display">المجموعة الأولى</span>
                                        <span class="team-score" id="team1Score">0/5</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="team-runner" id="team1Runner">🏃‍♂️</div>
                                    </div>
                                </div>
                                
                                <div class="team-track" id="team2Track">
                                    <div class="team-info">
                                        <span class="team-name" id="team2Display">المجموعة الثانية</span>
                                        <span class="team-score" id="team2Score">0/5</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="team-runner" id="team2Runner">🏃‍♀️</div>
                                    </div>
                                </div>
                                
                                <div class="team-track" id="team3Track">
                                    <div class="team-info">
                                        <span class="team-name" id="team3Display">المجموعة الثالثة</span>
                                        <span class="team-score" id="team3Score">0/5</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="team-runner" id="team3Runner">🏃</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- منطقة الأسئلة -->
                        <div class="question-area">
                            <div class="question-card" id="questionCard">
                                <h4 id="questionTitle">السؤال</h4>
                                <p id="questionText">انقر على "سؤال جديد" لبدء اللعبة</p>
                                <div class="answers" id="answersContainer"></div>
                                <div class="question-controls">
                                    <button onclick="newQuestion()" class="new-question-btn">❓ سؤال جديد</button>
                                    <button onclick="resetRace()" class="reset-race-btn">🔄 إعادة تشغيل السباق</button>
                                </div>
                            </div>
                        </div>

                        <!-- منطقة النتائج -->
                        <div class="results-area" id="resultsArea" style="display: none;">
                            <div class="winner-announcement">
                                <h3 id="winnerText">🏆 تهانينا!</h3>
                                <div class="confetti">🎉🎊✨🎈</div>
                                <button onclick="resetRace()" class="play-again-btn">🔄 لعب مرة أخرى</button>
                            </div>
                        </div>

                        <!-- منطقة التلميحات -->
                        <div class="hint-area" id="raceHint">
                            <div>💡 تلميح: مرر الماوس هنا لرؤية نصائح مفيدة</div>
                            <div class="hint-tooltip" id="hintTooltip">اقرأ السؤال بعناية وفكر في المرحلة المناسبة</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- لعبة الكنز المعرفي -->
            <div class="game-card" id="treasure-hunt" style="display: none;">
                <button class="close-btn" onclick="closeGame('treasure-hunt')">×</button>
                <h3>🏴‍☠️ الكنز المعرفي</h3>
                <div class="game-content active">
                    
                    <!-- إعداد اللعبة -->
                    <div class="treasure-setup" id="treasureSetup">
                        <div class="treasure-header">
                            <h4>🗺️ مرحباً بك في مغامرة الكنز المعرفي!</h4>
                            <p>اكتشف كنز إدارة المشاريع بترتيب مراحل دورة الحياة بالترتيب الصحيح</p>
                        </div>
                        
                        <div class="treasure-modes">
                            <h5>اختر نمط المغامرة:</h5>
                            <div class="treasure-mode-buttons">
                                <button onclick="startTreasureHunt('single')" class="treasure-mode-btn single-treasure">
                                    🧭 مغامرة فردية
                                    <span>اكتشف الكنز بمفردك واحصل على أفضل وقت</span>
                                </button>
                                <button onclick="startTreasureHunt('teams')" class="treasure-mode-btn teams-treasure">
                                    ⚔️ معركة الفرق
                                    <span>سباق بين الفرق للوصول للكنز أولاً</span>
                                </button>
                            </div>
                        </div>

                        <div class="treasure-teams-setup" id="treasureTeamsSetup" style="display: none;">
                            <h5>🏴‍☠️ أسماء الفرق المتنافسة:</h5>
                            <div class="treasure-teams-input">
                                <input type="text" id="treasureTeam1" placeholder="اسم الفريق الأول" value="قراصنة المعرفة">
                                <input type="text" id="treasureTeam2" placeholder="اسم الفريق الثاني" value="صيادو الكنوز">
                                <input type="text" id="treasureTeam3" placeholder="اسم الفريق الثالث" value="محاربو الإدارة">
                            </div>
                            <button onclick="startTeamsTreasureHunt()" class="start-treasure-btn">🚀 بدء المغامرة</button>
                        </div>
                    </div>

                    <!-- منطقة اللعبة -->
                    <div class="treasure-game-area" id="treasureGameArea" style="display: none;">
                        
                        <!-- لوحة المعلومات -->
                        <div class="treasure-dashboard">
                            <div class="treasure-info">
                                <h4 id="treasureGameTitle">🏴‍☠️ البحث عن الكنز</h4>
                                <div class="treasure-timer" id="treasureTimer">⏱️ 00:00</div>
                            </div>
                            
                            <div class="treasure-teams-status" id="treasureTeamsStatus">
                                <!-- سيتم ملؤها ديناميكياً -->
                            </div>
                            
                            <div class="treasure-progress">
                                <div class="progress-label">التقدم نحو الكنز:</div>
                                <div class="treasure-progress-bar">
                                    <div class="treasure-progress-fill" id="treasureProgressFill"></div>
                                    <div class="treasure-icon">💎</div>
                                </div>
                            </div>
                        </div>

                        <!-- منطقة البطاقات المبعثرة -->
                        <div class="scattered-cards-area">
                            <h4>🗂️ البطاقات المبعثرة - اسحبها وأفلتها في الترتيب الصحيح</h4>
                            <div class="scattered-cards" id="scatteredCards">
                                <!-- البطاقات المبعثرة -->
                            </div>
                        </div>

                        <!-- منطقة الترتيب -->
                        <div class="sorting-area">
                            <h4>📋 رتب مراحل دورة حياة المشروع:</h4>
                            <div class="drop-zones" id="dropZones">
                                <!-- مناطق الإفلات -->
                            </div>
                            <div class="treasure-controls">
                                <button onclick="checkTreasureOrder()" class="check-treasure-btn" id="checkTreasureBtn">🔍 فحص الترتيب</button>
                                <button onclick="shuffleCards()" class="shuffle-btn">🔄 خلط البطاقات</button>
                                <button onclick="resetTreasureGame()" class="reset-treasure-btn">🏴‍☠️ مغامرة جديدة</button>
                            </div>
                        </div>

                        <!-- منطقة النتائج -->
                        <div class="treasure-results" id="treasureResults" style="display: none;">
                            <div class="treasure-celebration">
                                <h3 id="treasureWinnerText">🏆 تم اكتشاف الكنز!</h3>
                                <div class="treasure-chest">💰💎🏆✨</div>
                                <div class="treasure-final-time" id="treasureFinalTime"></div>
                                <div class="treasure-ranking" id="treasureRanking"></div>
                                <button onclick="resetTreasureGame()" class="new-treasure-btn">🗺️ مغامرة جديدة</button>
                            </div>
                        </div>

                        <!-- منطقة التلميحات -->
                        <div class="treasure-hints" id="treasureHints">
                            <div class="hint-card">
                                💡 <strong>تلميح:</strong> ابدأ بمرحلة "البدء" وانتهِ بمرحلة "الإنهاء"
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- لعبة بناء المشروع -->
            <div class="game-card" id="project-builder" style="display: none;">
                <button class="close-btn" onclick="closeGame('project-builder')">×</button>
                <h3>🏗️ بناء المشروع</h3>
                <div class="game-content active">
                    
                    <!-- إعداد اللعبة -->
                    <div class="builder-setup" id="builderSetup">
                        <div class="builder-header">
                            <h4>🏗️ مرحباً بك في ورشة بناء المشروع!</h4>
                            <p>اختر وركب قطع المشروع الافتراضية لبناء مشروع ناجح ومتكامل</p>
                        </div>
                        
                        <div class="builder-modes">
                            <h5>اختر نمط البناء:</h5>
                            <div class="builder-mode-buttons">
                                <button onclick="startProjectBuilder('single')" class="builder-mode-btn single-builder">
                                    🧑‍💼 مهندس واحد
                                    <span>ابنِ مشروعك بمفردك واحصل على أفضل وقت</span>
                                </button>
                                <button onclick="startProjectBuilder('teams')" class="builder-mode-btn teams-builder">
                                    👥 فرق البناء
                                    <span>سباق بين الفرق لإكمال البناء أولاً</span>
                                </button>
                            </div>
                        </div>

                        <div class="builder-teams-setup" id="builderTeamsSetup" style="display: none;">
                            <h5>🏗️ أسماء فرق البناء:</h5>
                            <div class="builder-teams-input">
                                <input type="text" id="builderTeam1" placeholder="اسم الفريق الأول" value="مهندسو المستقبل">
                                <input type="text" id="builderTeam2" placeholder="اسم الفريق الثاني" value="بناة النجاح">
                                <input type="text" id="builderTeam3" placeholder="اسم الفريق الثالث" value="خبراء الإدارة">
                            </div>
                            <button onclick="startTeamsProjectBuilder()" class="start-builder-btn">🚀 بدء البناء</button>
                        </div>
                    </div>

                    <!-- منطقة اللعبة -->
                    <div class="builder-game-area" id="builderGameArea" style="display: none;">
                        
                        <!-- لوحة المعلومات -->
                        <div class="builder-dashboard">
                            <div class="builder-info">
                                <h4 id="builderGameTitle">🏗️ ورشة بناء المشروع</h4>
                                <div class="builder-timer" id="builderTimer">⏱️ 00:00</div>
                            </div>
                            
                            <div class="builder-teams-status" id="builderTeamsStatus">
                                <!-- سيتم ملؤها ديناميكياً -->
                            </div>
                            
                            <div class="builder-progress">
                                <div class="builder-progress-label">تقدم البناء:</div>
                                <div class="builder-progress-bar">
                                    <div class="builder-progress-fill" id="builderProgressFill"></div>
                                    <div class="builder-icon">🏗️</div>
                                </div>
                            </div>
                        </div>

                        <!-- منطقة قطع المشروع -->
                        <div class="components-area">
                            <h4>🧩 قطع المشروع المتاحة - اسحبها وأفلتها في الأساس</h4>
                            <div class="project-components" id="projectComponents">
                                <!-- قطع المشروع -->
                            </div>
                        </div>

                        <!-- منطقة البناء -->
                        <div class="building-area">
                            <h4>🏗️ أساس المشروع - رتب القطع لبناء مشروع ناجح:</h4>
                            <div class="project-foundation">
                                <div class="foundation-layers" id="foundationLayers">
                                    <!-- طبقات الأساس -->
                                </div>
                            </div>
                            <div class="builder-controls">
                                <button onclick="checkProjectBuild()" class="check-build-btn" id="checkBuildBtn">🔍 فحص البناء</button>
                                <button onclick="shuffleComponents()" class="shuffle-components-btn">🔄 خلط القطع</button>
                                <button onclick="resetProjectBuilder()" class="reset-builder-btn">🏗️ بناء جديد</button>
                            </div>
                        </div>

                        <!-- منطقة النتائج -->
                        <div class="builder-results" id="builderResults" style="display: none;">
                            <div class="builder-celebration">
                                <h3 id="builderWinnerText">🏆 تم إكمال البناء!</h3>
                                <div class="project-building">🏗️🏢✨🎉</div>
                                <div class="builder-final-time" id="builderFinalTime"></div>
                                <div class="builder-ranking" id="builderRanking"></div>
                                <button onclick="resetProjectBuilder()" class="new-builder-btn">🏗️ مشروع جديد</button>
                            </div>
                        </div>

                        <!-- منطقة التلميحات -->
                        <div class="builder-hints" id="builderHints">
                            <div class="builder-hint-card">
                                💡 <strong>تلميح:</strong> ابدأ بمدير المشروع كأساس، ثم أضف باقي القطع بترتيب منطقي
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- لعبة الأدوار -->
            <div class="game-card" id="role-play" style="display: none;">
                <button class="close-btn" onclick="closeGame('role-play')">×</button>
                <h3>🎭 لعبة الأدوار</h3>
                <div class="game-content active">
                    
                    <!-- إعداد اللعبة -->
                    <div class="roleplay-setup" id="roleplaySetup">
                        <div class="roleplay-header">
                            <h4>🎬 مرحباً بك في مسرح إدارة المشاريع!</h4>
                            <p>تمثيل أدوار مديري المشاريع في سيناريوهات واقعية مع التصويت للحل الأفضل</p>
                        </div>
                        
                        <div class="roleplay-modes">
                            <h5>اختر نمط التمثيل:</h5>
                            <div class="roleplay-mode-buttons">
                                <button onclick="startRoleplay('single')" class="roleplay-mode-btn single-roleplay">
                                    🎭 ممثل واحد
                                    <span>تمثيل فردي مع تقييم الأداء</span>
                                </button>
                                <button onclick="startRoleplay('teams')" class="roleplay-mode-btn teams-roleplay">
                                    👥 فرق التمثيل
                                    <span>منافسة بين الفرق مع التصويت</span>
                                </button>
                            </div>
                        </div>

                        <div class="roleplay-teams-setup" id="roleplayTeamsSetup" style="display: none;">
                            <h5>🎭 أسماء فرق التمثيل:</h5>
                            <div class="roleplay-teams-input">
                                <input type="text" id="roleplayTeam1" placeholder="اسم الفريق الأول" value="مديرو المستقبل">
                                <input type="text" id="roleplayTeam2" placeholder="اسم الفريق الثاني" value="خبراء الحلول">
                                <input type="text" id="roleplayTeam3" placeholder="اسم الفريق الثالث" value="محترفو الإدارة">
                            </div>
                            <button onclick="startTeamsRoleplay()" class="start-roleplay-btn">🎬 بدء العرض</button>
                        </div>
                    </div>

                    <!-- منطقة اللعبة -->
                    <div class="roleplay-game-area" id="roleplayGameArea" style="display: none;">
                        
                        <!-- لوحة المعلومات -->
                        <div class="roleplay-dashboard">
                            <div class="roleplay-info">
                                <h4 id="roleplayGameTitle">🎭 مسرح إدارة المشاريع</h4>
                                <div class="roleplay-round" id="roleplayRound">الجولة 1</div>
                            </div>
                            
                            <div class="roleplay-teams-status" id="roleplayTeamsStatus">
                                <!-- سيتم ملؤها ديناميكياً -->
                            </div>
                        </div>

                        <!-- منطقة السيناريو -->
                        <div class="scenario-area">
                            <div class="scenario-header">
                                <h4 class="scenario-title" id="scenarioTitle">السيناريو الحالي</h4>
                                <span class="scenario-category" id="scenarioCategory">إدارة المخاطر</span>
                            </div>
                            
                            <div class="scenario-content">
                                <div class="scenario-description" id="scenarioDescription">
                                    انقر على "سيناريو جديد" لبدء التمثيل
                                </div>
                                
                                <div class="scenario-details" id="scenarioDetails" style="display: none;">
                                    <h6>تفاصيل الموقف:</h6>
                                    <ul id="scenarioDetailsList"></ul>
                                </div>
                                
                                <div class="scenario-challenge" id="scenarioChallenge" style="display: none;">
                                    <h6>🎯 التحدي:</h6>
                                    <p id="scenarioChallengeText"></p>
                                </div>
                            </div>
                        </div>

                        <!-- منطقة العروض -->
                        <div class="teams-presentation" id="teamsPresentation" style="display: none;">
                            <h4>🎬 عروض الفرق - كل فريق يقدم حله</h4>
                            <div class="presentation-slots" id="presentationSlots">
                                <!-- سيتم ملؤها ديناميكياً -->
                            </div>
                        </div>

                        <!-- منطقة التصويت -->
                        <div class="voting-area" id="votingArea" style="display: none;">
                            <div class="voting-header">
                                <h4>🗳️ التصويت للحل الأفضل</h4>
                                <p class="voting-instructions">اختر الفريق الذي قدم الحل الأكثر إقناعاً وعملية</p>
                            </div>
                            
                            <div class="voting-options" id="votingOptions">
                                <!-- سيتم ملؤها ديناميكياً -->
                            </div>
                            
                            <div class="voting-controls">
                                <button onclick="castVote()" class="cast-vote-btn" id="castVoteBtn">🗳️ تسجيل الصوت</button>
                                <button onclick="showRoleplayResults()" class="show-results-btn" id="showResultsBtn" style="display: none;">📊 عرض النتائج</button>
                            </div>
                        </div>

                        <!-- منطقة النتائج -->
                        <div class="roleplay-results" id="roleplayResults" style="display: none;">
                            <div class="roleplay-celebration">
                                <h3 id="roleplayWinnerText">🏆 انتهت الجولة!</h3>
                                <div class="winner-podium" id="winnerPodium">
                                    <!-- سيتم ملؤها ديناميكياً -->
                                </div>
                            </div>
                        </div>

                        <!-- أزرار التحكم -->
                        <div class="scenario-controls">
                            <button onclick="newScenario()" class="new-scenario-btn">🎬 سيناريو جديد</button>
                            <button onclick="resetRoleplay()" class="reset-roleplay-btn">🔄 إعادة تشغيل</button>
                        </div>

                        <!-- منطقة النصائح -->
                        <div class="roleplay-tips" id="roleplayTips">
                            <div class="roleplay-tip-card">
                                💡 <strong>نصيحة:</strong> فكر كمدير مشروع محترف واعرض حلولاً عملية ومقنعة
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- لعبة التحدي السريع -->
            <div class="game-card" id="quick-challenge" style="display: none;">
                <button class="close-btn" onclick="closeGame('quick-challenge')">×</button>
                <h3>⚡ التحدي السريع</h3>
                <div class="game-content active">
                    
                    <!-- إعداد اللعبة -->
                    <div class="challenge-setup" id="challengeSetup">
                        <div class="setup-header">
                            <h4>🎯 إعداد التحدي السريع</h4>
                            <p>لعبة أسئلة سريعة عن إدارة المشاريع للصف الثالث ثانوي</p>
                        </div>
                        
                        <div class="game-modes">
                            <h5>اختر نمط اللعبة:</h5>
                            <div class="mode-buttons">
                                <button onclick="startChallenge('single')" class="mode-btn single-mode">
                                    👤 لاعب واحد
                                    <span>تحدى نفسك واحصل على أعلى نقاط</span>
                                </button>
                                <button onclick="startChallenge('team')" class="mode-btn team-mode">
                                    👥 فرق متنافسة
                                    <span>منافسة بين الفرق للحصول على أعلى نقاط</span>
                                </button>
                            </div>
                        </div>

                        <div class="team-setup-challenge" id="teamSetupChallenge" style="display: none;">
                            <h5>أسماء الفرق:</h5>
                            <div class="teams-input">
                                <input type="text" id="challengeTeam1" placeholder="اسم الفريق الأول" value="الفريق الأول">
                                <input type="text" id="challengeTeam2" placeholder="اسم الفريق الثاني" value="الفريق الثاني">
                            </div>
                            <button onclick="startTeamChallenge()" class="start-challenge-btn">🚀 بدء التحدي</button>
                        </div>
                    </div>

                    <!-- منطقة اللعبة -->
                    <div class="challenge-area" id="challengeArea" style="display: none;">
                        
                        <!-- لوحة النقاط -->
                        <div class="scoreboard">
                            <div class="score-header">
                                <h4 id="gameTitle">⚡ التحدي السريع</h4>
                                <div class="timer" id="questionTimer">⏱️ 30</div>
                            </div>
                            
                            <div class="scores-display" id="scoresDisplay">
                                <!-- سيتم ملؤها ديناميكياً -->
                            </div>
                            
                            <div class="game-stats">
                                <span class="stat">السؤال: <span id="questionNumber">1</span>/20</span>
                                <span class="stat">النوع: <span id="questionType">اختيار من متعدد</span></span>
                            </div>
                        </div>

                        <!-- بطاقة السؤال -->
                        <div class="question-challenge-card">
                            <div class="question-header">
                                <span class="question-category" id="questionCategory">إدارة الموارد</span>
                                <span class="question-difficulty" id="questionDifficulty">متوسط</span>
                            </div>
                            
                            <div class="question-content">
                                <h4 id="challengeQuestionText">انقر على "سؤال جديد" لبدء التحدي</h4>
                                <div class="answers-challenge" id="challengeAnswers"></div>
                            </div>
                            
                            <div class="question-footer">
                                <button onclick="nextChallengeQuestion()" class="next-question-btn" id="nextQuestionBtn">❓ سؤال جديد</button>
                                <button onclick="skipQuestion()" class="skip-btn" id="skipBtn" style="display: none;">⏭️ تخطي</button>
                            </div>
                        </div>

                        <!-- منطقة النتائج -->
                        <div class="challenge-results" id="challengeResults" style="display: none;">
                            <div class="results-content">
                                <h3 id="finalResultTitle">🏆 انتهى التحدي!</h3>
                                <div class="final-scores" id="finalScores"></div>
                                <div class="performance-analysis" id="performanceAnalysis"></div>
                                <div class="results-actions">
                                    <button onclick="restartChallenge()" class="restart-btn">🔄 تحدي جديد</button>
                                    <button onclick="reviewAnswers()" class="review-btn">📋 مراجعة الإجابات</button>
                                </div>
                            </div>
                        </div>

                        <!-- منطقة المراجعة -->
                        <div class="review-area" id="reviewArea" style="display: none;">
                            <div class="review-header">
                                <h4>📋 مراجعة الإجابات</h4>
                                <button onclick="closeReview()" class="close-review-btn">✖️ إغلاق</button>
                            </div>
                            <div class="review-content" id="reviewContent"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // متغيرات لعبة السباق
        let teams = [];
        let currentQuestionIndex = 0;
        let gameQuestions = [];
        let currentStage = 0;
        
        const stages = ['البدء', 'التخطيط', 'التنفيذ', 'المراقبة والتحكم', 'الإنهاء'];
        
        // بنك الأسئلة لكل مرحلة
        const questionBank = {
            0: [ // مرحلة البدء
                {
                    question: "ما هو الهدف الرئيسي من مرحلة بدء المشروع؟",
                    answers: ["تحديد نطاق المشروع وأهدافه", "تنفيذ المهام", "مراقبة التقدم", "إنهاء المشروع"],
                    correct: 0,
                    hint: "فكر في الخطوة الأولى لأي مشروع جديد"
                },
                {
                    question: "من المسؤول عن اعتماد بدء المشروع؟",
                    answers: ["فريق المشروع", "راعي المشروع", "العملاء", "المطورون"],
                    correct: 1,
                    hint: "الشخص الذي يملك السلطة والموارد"
                }
            ],
            1: [ // مرحلة التخطيط
                {
                    question: "ما هي أهم مخرجات مرحلة التخطيط؟",
                    answers: ["المنتج النهائي", "خطة إدارة المشروع", "تقرير الإنجاز", "ميزانية المشروع فقط"],
                    correct: 1,
                    hint: "الوثيقة الشاملة التي توجه تنفيذ المشروع"
                },
                {
                    question: "أي من التالي يتم في مرحلة التخطيط؟",
                    answers: ["تسليم المنتج", "تحديد المخاطر والاستجابة لها", "إغلاق المشروع", "بدء التنفيذ"],
                    correct: 1,
                    hint: "التفكير المسبق في المشاكل المحتملة"
                }
            ],
            2: [ // مرحلة التنفيذ
                {
                    question: "ما هو التركيز الرئيسي في مرحلة التنفيذ؟",
                    answers: ["التخطيط للمهام", "تنفيذ خطة المشروع", "مراجعة النتائج", "إعداد التقارير"],
                    correct: 1,
                    hint: "تحويل الخطط إلى واقع ملموس"
                },
                {
                    question: "من أهم أنشطة مرحلة التنفيذ:",
                    answers: ["وضع الميزانية", "توجيه وإدارة عمل المشروع", "تحديد المتطلبات", "إنهاء المشروع"],
                    correct: 1,
                    hint: "قيادة الفريق لإنجاز المهام المخططة"
                }
            ],
            3: [ // مرحلة المراقبة والتحكم
                {
                    question: "ما الغرض من مرحلة المراقبة والتحكم؟",
                    answers: ["بدء المشروع", "تتبع وقياس ومراجعة التقدم", "تسليم المنتج", "تحديد الأهداف"],
                    correct: 1,
                    hint: "التأكد من سير المشروع وفق الخطة"
                },
                {
                    question: "متى تحدث عمليات المراقبة والتحكم؟",
                    answers: ["في بداية المشروع فقط", "في نهاية المشروع فقط", "طوال دورة حياة المشروع", "في مرحلة التخطيط فقط"],
                    correct: 2,
                    hint: "عملية مستمرة من البداية للنهاية"
                }
            ],
            4: [ // مرحلة الإنهاء
                {
                    question: "ما هو الهدف من مرحلة إنهاء المشروع؟",
                    answers: ["بدء مشروع جديد", "إنهاء جميع أنشطة المشروع رسمياً", "تخطيط المهام", "تنفيذ المتطلبات"],
                    correct: 1,
                    hint: "الإغلاق الرسمي والتسليم النهائي"
                },
                {
                    question: "من أنشطة مرحلة الإنهاء:",
                    answers: ["تحديد المتطلبات", "توثيق الدروس المستفادة", "بدء التنفيذ", "وضع الخطة"],
                    correct: 1,
                    hint: "الاستفادة من تجربة المشروع للمستقبل"
                }
            ]
        };

        // متغيرات لعبة الكنز المعرفي
        let treasureMode = '';
        let treasureTeams = [];
        let treasureStartTime = null;
        let treasureTimer = null;
        let treasureCards = [];
        let correctOrder = ['البدء', 'التخطيط', 'التنفيذ', 'المراقبة والتحكم', 'الإنهاء'];
        let currentTreasureOrder = [];
        let treasureGameActive = false;
        let treasureCompletionTimes = [];

        // متغيرات لعبة بناء المشروع
        let builderMode = '';
        let builderTeams = [];
        let builderStartTime = null;
        let builderTimer = null;
        let projectComponents = [];
        let currentBuildOrder = [];
        let builderGameActive = false;
        let builderCompletionTimes = [];

        // قطع المشروع وترتيبها الصحيح
        const projectPieces = [
            {
                id: 'manager',
                name: 'مدير المشروع',
                icon: '👨‍💼',
                description: 'القائد المسؤول عن إدارة وتوجيه المشروع',
                layer: 0, // الأساس
                importance: 'أساسي'
            },
            {
                id: 'scope',
                name: 'النطاق',
                icon: '🎯',
                description: 'تحديد حدود وأهداف المشروع',
                layer: 1,
                importance: 'أساسي'
            },
            {
                id: 'plan',
                name: 'الخطة',
                icon: '📋',
                description: 'الخطة الشاملة لتنفيذ المشروع',
                layer: 2,
                importance: 'أساسي'
            },
            {
                id: 'team',
                name: 'الفريق',
                icon: '👥',
                description: 'أعضاء الفريق المسؤولون عن التنفيذ',
                layer: 3,
                importance: 'أساسي'
            },
            {
                id: 'resources',
                name: 'الموارد',
                icon: '🔧',
                description: 'الأدوات والمعدات اللازمة للمشروع',
                layer: 4,
                importance: 'أساسي'
            },
            {
                id: 'time',
                name: 'الزمن',
                icon: '⏰',
                description: 'الجدولة الزمنية والمواعيد النهائية',
                layer: 5,
                importance: 'أساسي'
            },
            {
                id: 'cost',
                name: 'التكلفة',
                icon: '💰',
                description: 'الميزانية والتكاليف المالية',
                layer: 6,
                importance: 'أساسي'
            }
        ];

        const correctBuildOrder = ['manager', 'scope', 'plan', 'team', 'resources', 'time', 'cost'];

        // متغيرات لعبة الأدوار
        let roleplayMode = '';
        let roleplayTeams = [];
        let currentScenario = null;
        let currentRound = 1;
        let roleplayVotes = {};
        let selectedVote = null;
        let presentationTimers = {};
        let roleplayGameActive = false;

        // متغيرات لعبة التحدي السريع
        let challengeMode = '';
        let challengeTeams = [];
        let currentChallengeQuestion = 0;
        let challengeQuestions = [];
        let gameTimer = null;
        let timeLeft = 30;
        let gameAnswers = [];
        let isGameActive = false;

        // بنك سيناريوهات لعبة الأدوار
        const scenarioBank = [
            {
                id: 1,
                title: "تأخر المورد عن التسليم",
                category: "إدارة المخاطر",
                description: "تواجه مشروعك أزمة حقيقية! المورد الرئيسي للمواد الخام تأخر عن التسليم بأسبوعين كاملين، مما يهدد الجدولة الزمنية للمشروع بأكمله.",
                details: [
                    "المورد يواجه مشاكل في سلسلة التوريد",
                    "العميل يتوقع التسليم في الموعد المحدد",
                    "الفريق في انتظار المواد لبدء المرحلة التالية",
                    "هناك موردين بديلين لكن بتكلفة أعلى",
                    "التأخير قد يؤثر على مشاريع أخرى"
                ],
                challenge: "كيف ستتعامل مع هذا الموقف كمدير مشروع محترف؟ اعرض خطة عمل شاملة تتضمن الحلول البديلة وإدارة التوقعات."
            },
            {
                id: 2,
                title: "تضارب بين أعضاء الفريق",
                category: "إدارة الفريق",
                description: "نشب خلاف حاد بين اثنين من أهم أعضاء فريقك حول الطريقة الأمثل لتنفيذ مهمة حاسمة في المشروع، مما أثر على معنويات الفريق وإنتاجيته.",
                details: [
                    "الخلاف حول منهجية التنفيذ التقنية",
                    "كلا العضوين لديهما خبرة وآراء قوية",
                    "باقي أعضاء الفريق منقسمون في الآراء",
                    "المهمة مهمة وتحتاج قرار سريع",
                    "العلاقات الشخصية بدأت تتأثر سلبياً"
                ],
                challenge: "كيف ستحل هذا التضارب وتعيد الانسجام للفريق؟ اعرض استراتيجية شاملة لإدارة الصراع واتخاذ القرار الأمثل."
            },
            {
                id: 3,
                title: "زيادة غير متوقعة في التكلفة",
                category: "إدارة الميزانية",
                description: "اكتشفت أن تكلفة المشروع ستتجاوز الميزانية المعتمدة بنسبة 25% بسبب تغييرات في متطلبات العميل وارتفاع أسعار المواد.",
                details: [
                    "العميل طلب تحسينات إضافية لم تكن في النطاق الأصلي",
                    "أسعار المواد ارتفعت بشكل غير متوقع",
                    "الميزانية الإضافية تحتاج موافقة الإدارة العليا",
                    "هناك ضغط لإنهاء المشروع في الوقت المحدد",
                    "قد تحتاج لتقليل بعض المميزات لتوفير التكلفة"
                ],
                challenge: "كيف ستتعامل مع هذه الزيادة في التكلفة؟ اعرض خطة لإدارة الميزانية والتفاوض مع العميل والإدارة."
            },
            {
                id: 4,
                title: "مغادرة عضو رئيسي من الفريق",
                category: "إدارة الموارد البشرية",
                description: "قدم المطور الرئيسي في فريقك استقالته المفاجئة لظروف شخصية، وهو يحمل معرفة تقنية حاسمة للمشروع ولا يمكن استبداله بسهولة.",
                details: [
                    "المطور يملك معرفة فريدة بالنظام",
                    "فترة الإشعار قصيرة (أسبوعين فقط)",
                    "صعوبة في إيجاد بديل بنفس الخبرة",
                    "المشروع في مرحلة حرجة",
                    "باقي الفريق قلق من زيادة العبء عليهم"
                ],
                challenge: "كيف ستدير هذا الموقف وتضمن استمرارية المشروع؟ اعرض خطة لنقل المعرفة وإعادة توزيع المهام."
            },
            {
                id: 5,
                title: "تغيير مفاجئ في متطلبات العميل",
                category: "إدارة النطاق",
                description: "طلب العميل تغييرات جوهرية في المشروع بعد إنجاز 60% من العمل، مما يتطلب إعادة تصميم أجزاء كبيرة وتأثير على الجدولة والميزانية.",
                details: [
                    "التغييرات تؤثر على الهيكل الأساسي للمشروع",
                    "العميل يصر على عدم تمديد الموعد النهائي",
                    "الفريق محبط من إعادة العمل المنجز",
                    "التغييرات تتطلب مهارات جديدة",
                    "قد تحتاج لموارد إضافية"
                ],
                challenge: "كيف ستتعامل مع هذا التغيير الجذري؟ اعرض استراتيجية لإدارة التغيير والتفاوض مع العميل."
            },
            {
                id: 6,
                title: "مشكلة تقنية معقدة",
                category: "إدارة المخاطر التقنية",
                description: "واجه فريقك مشكلة تقنية معقدة لم تكن متوقعة، والحلول المقترحة إما مكلفة جداً أو تحتاج وقت طويل للتطوير.",
                details: [
                    "المشكلة تؤثر على الوظائف الأساسية",
                    "الحلول التقليدية غير فعالة",
                    "قد تحتاج لاستشارة خبراء خارجيين",
                    "العميل غير راضٍ عن التأخير",
                    "الفريق يشعر بالإحباط والضغط"
                ],
                challenge: "كيف ستقود فريقك لحل هذه المشكلة التقنية؟ اعرض خطة شاملة للبحث عن الحلول وإدارة التوقعات."
            },
            {
                id: 7,
                title: "ضغط زمني شديد",
                category: "إدارة الوقت",
                description: "طلبت الإدارة العليا تسريع المشروع وتسليمه قبل الموعد المخطط بشهر كامل لاستغلال فرصة تجارية مهمة، دون زيادة الموارد.",
                details: [
                    "الفرصة التجارية مربحة جداً للشركة",
                    "لا يمكن زيادة عدد أعضاء الفريق",
                    "جودة المنتج يجب أن تبقى عالية",
                    "الفريق يعمل بطاقته القصوى حالياً",
                    "هناك مخاطر من الأخطاء بسبب السرعة"
                ],
                challenge: "كيف ستحقق هذا الهدف الطموح؟ اعرض خطة لتسريع العمل مع الحفاظ على الجودة ومعنويات الفريق."
            },
            {
                id: 8,
                title: "مشكلة في التواصل مع العميل",
                category: "إدارة التواصل",
                description: "العميل غير راضٍ عن مستوى التواصل ويشكو من عدم وضوح التقارير وقلة التحديثات، مما أثر على ثقته في الفريق والمشروع.",
                details: [
                    "العميل يشعر بأنه خارج دائرة المعلومات",
                    "التقارير الحالية تقنية ومعقدة",
                    "هناك سوء فهم حول التقدم المحرز",
                    "العميل يفكر في تغيير مقدم الخدمة",
                    "الفريق يركز على العمل أكثر من التواصل"
                ],
                challenge: "كيف ستحسن التواصل مع العميل وتستعيد ثقته؟ اعرض استراتيجية شاملة للتواصل الفعال."
            }
        ];

        // بنك أسئلة التحدي السريع
        const challengeQuestionBank = [
            // أسئلة اختيار من متعدد
            {
                type: 'multiple',
                category: 'إدارة الموارد',
                difficulty: 'متوسط',
                question: 'أي من الموارد التالية يمكن تخزينه؟',
                answers: ['الأجهزة', 'أعضاء الفريق', 'الاجتماعات', 'الخبرات'],
                correct: 0,
                explanation: 'الأجهزة هي موارد مادية يمكن تخزينها، بينما الموارد البشرية والاجتماعات لا يمكن تخزينها'
            },
            {
                type: 'multiple',
                category: 'العلاقات بين المهام',
                difficulty: 'متوسط',
                question: 'العلاقة (Finish to Finish) تعني أن المهمتين:',
                answers: ['تبدآن معاً', 'تنتهيان معاً', 'لا علاقة بينهما', 'إحداهما تبدأ عند انتهاء الأخرى'],
                correct: 1,
                explanation: 'علاقة Finish to Finish تعني أن المهمتين يجب أن تنتهيا في نفس الوقت'
            },
            {
                type: 'multiple',
                category: 'إدارة المشاريع',
                difficulty: 'سهل',
                question: 'ما هو الهدف الرئيسي من إدارة المشاريع؟',
                answers: ['زيادة التكاليف', 'تحقيق أهداف المشروع بكفاءة', 'إطالة مدة المشروع', 'تعقيد العمليات'],
                correct: 1,
                explanation: 'الهدف الأساسي هو تحقيق أهداف المشروع في الوقت والميزانية المحددة'
            },
            {
                type: 'multiple',
                category: 'مراحل المشروع',
                difficulty: 'متوسط',
                question: 'أي مرحلة تأتي مباشرة بعد مرحلة التخطيط؟',
                answers: ['البدء', 'التنفيذ', 'المراقبة', 'الإنهاء'],
                correct: 1,
                explanation: 'مرحلة التنفيذ تأتي بعد التخطيط لتطبيق الخطط الموضوعة'
            },
            {
                type: 'multiple',
                category: 'إدارة المخاطر',
                difficulty: 'صعب',
                question: 'ما هي أفضل استراتيجية للتعامل مع المخاطر عالية الاحتمال والتأثير؟',
                answers: ['التجاهل', 'التخفيف', 'التجنب', 'القبول'],
                correct: 2,
                explanation: 'المخاطر عالية الاحتمال والتأثير يجب تجنبها تماماً إن أمكن'
            },
            {
                type: 'multiple',
                category: 'فريق المشروع',
                difficulty: 'سهل',
                question: 'من المسؤول عن قيادة فريق المشروع؟',
                answers: ['العميل', 'مدير المشروع', 'المطور الرئيسي', 'المحاسب'],
                correct: 1,
                explanation: 'مدير المشروع هو المسؤول عن قيادة وتوجيه فريق المشروع'
            },
            {
                type: 'multiple',
                category: 'الجودة',
                difficulty: 'متوسط',
                question: 'متى يجب التحقق من جودة المنتج؟',
                answers: ['في النهاية فقط', 'في البداية فقط', 'طوال دورة حياة المشروع', 'عند حدوث مشاكل'],
                correct: 2,
                explanation: 'مراقبة الجودة يجب أن تكون عملية مستمرة طوال المشروع'
            },
            {
                type: 'multiple',
                category: 'التواصل',
                difficulty: 'سهل',
                question: 'ما أهمية التواصل في إدارة المشاريع؟',
                answers: ['غير مهم', 'مهم أحياناً', 'أساسي لنجاح المشروع', 'يعقد العمل'],
                correct: 2,
                explanation: 'التواصل الفعال أساسي لضمان تنسيق الجهود ونجاح المشروع'
            },

            // أسئلة صح وخطأ
            {
                type: 'truefalse',
                category: 'مسؤوليات مدير المشروع',
                difficulty: 'سهل',
                question: 'مدير المشروع يضع الخطة ويتابع التنفيذ',
                correct: true,
                explanation: 'صحيح - من أهم مسؤوليات مدير المشروع وضع الخطط ومتابعة تنفيذها'
            },
            {
                type: 'truefalse',
                category: 'نطاق المشروع',
                difficulty: 'متوسط',
                question: 'يمكن تغيير نطاق المشروع في أي وقت دون موافقة',
                correct: false,
                explanation: 'خطأ - تغيير النطاق يتطلب موافقة رسمية وتقييم للتأثير على الوقت والتكلفة'
            },
            {
                type: 'truefalse',
                category: 'الميزانية',
                difficulty: 'سهل',
                question: 'مراقبة الميزانية مهمة فقط في نهاية المشروع',
                correct: false,
                explanation: 'خطأ - مراقبة الميزانية يجب أن تكون مستمرة طوال المشروع'
            },
            {
                type: 'truefalse',
                category: 'المخاطر',
                difficulty: 'متوسط',
                question: 'جميع المخاطر في المشروع يمكن تجنبها تماماً',
                correct: false,
                explanation: 'خطأ - بعض المخاطر لا يمكن تجنبها ويجب إدارتها والاستعداد لها'
            },
            {
                type: 'truefalse',
                category: 'التخطيط',
                difficulty: 'سهل',
                question: 'التخطيط الجيد يقلل من احتمالية فشل المشروع',
                correct: true,
                explanation: 'صحيح - التخطيط الجيد يساعد في تجنب المشاكل وزيادة فرص النجاح'
            },
            {
                type: 'truefalse',
                category: 'الفريق',
                difficulty: 'متوسط',
                question: 'جميع أعضاء الفريق يجب أن يكونوا خبراء في جميع مجالات المشروع',
                correct: false,
                explanation: 'خطأ - التنوع في المهارات والتخصصات يقوي الفريق'
            },
            {
                type: 'truefalse',
                category: 'الجدولة',
                difficulty: 'سهل',
                question: 'الجدولة الزمنية للمشروع يجب أن تكون مرنة',
                correct: true,
                explanation: 'صحيح - المرونة في الجدولة تساعد في التعامل مع التغييرات والمشاكل'
            },
            {
                type: 'truefalse',
                category: 'التسليم',
                difficulty: 'متوسط',
                question: 'يمكن تسليم المشروع دون اختبار المنتج النهائي',
                correct: false,
                explanation: 'خطأ - الاختبار ضروري لضمان جودة المنتج قبل التسليم'
            }
        ];

        // وظائف اللعبة
        function openGame(gameId) {
            // إخفاء الشبكة الرئيسية وإظهار منطقة الألعاب
            document.getElementById('gamesGrid').style.display = 'none';
            document.getElementById('gamesContainer').style.display = 'block';
            
            // إخفاء جميع الألعاب
            document.querySelectorAll('.game-card').forEach(card => {
                card.style.display = 'none';
            });
            
            // إظهار اللعبة المحددة
            const gameCard = document.getElementById(gameId);
            if (gameCard) {
                gameCard.style.display = 'block';
                addSparkleEffect(gameCard);
            }
        }

        function closeGame(gameId) {
            // إخفاء اللعبة الحالية
            document.getElementById(gameId).style.display = 'none';
            
            // إظهار الشبكة الرئيسية وإخفاء منطقة الألعاب
            document.getElementById('gamesContainer').style.display = 'none';
            document.getElementById('gamesGrid').style.display = 'grid';
        }

        function startRace() {
            // جمع أسماء المجموعات
            teams = [
                {
                    name: document.getElementById('team1Name').value || 'المجموعة الأولى',
                    score: 0,
                    position: 0
                },
                {
                    name: document.getElementById('team2Name').value || 'المجموعة الثانية',
                    score: 0,
                    position: 0
                },
                {
                    name: document.getElementById('team3Name').value || 'المجموعة الثالثة',
                    score: 0,
                    position: 0
                }
            ];

            // تحديث أسماء المجموعات في واجهة السباق
            document.getElementById('team1Display').textContent = teams[0].name;
            document.getElementById('team2Display').textContent = teams[1].name;
            document.getElementById('team3Display').textContent = teams[2].name;

            // إخفاء إعداد المجموعات وإظهار منطقة السباق
            document.getElementById('teamsSetup').style.display = 'none';
            document.getElementById('raceArea').style.display = 'block';

            // تحضير الأسئلة
            prepareQuestions();
            updateRaceDisplay();
        }

        function prepareQuestions() {
            gameQuestions = [];
            // اختيار سؤالين من كل مرحلة
            for (let stage = 0; stage < 5; stage++) {
                const stageQuestions = questionBank[stage];
                gameQuestions.push(...stageQuestions);
            }
            // خلط الأسئلة
            gameQuestions = gameQuestions.sort(() => Math.random() - 0.5);
            currentQuestionIndex = 0;
        }

        function newQuestion() {
            if (currentQuestionIndex >= gameQuestions.length) {
                prepareQuestions(); // إعادة تحضير الأسئلة
            }

            const question = gameQuestions[currentQuestionIndex];
            
            document.getElementById('questionTitle').textContent = `السؤال ${currentQuestionIndex + 1}`;
            document.getElementById('questionText').textContent = question.question;
            
            const answersContainer = document.getElementById('answersContainer');
            answersContainer.innerHTML = '';
            
            question.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'answer-btn';
                button.textContent = answer;
                button.onclick = () => checkAnswer(index, question.correct, question.hint);
                answersContainer.appendChild(button);
            });

            // إخفاء التلميح
            document.getElementById('raceHint').classList.remove('show');
        }

        function checkAnswer(selectedIndex, correctIndex, hint) {
            const buttons = document.querySelectorAll('.answer-btn');
            
            // تعطيل جميع الأزرار
            buttons.forEach(btn => btn.disabled = true);
            
            if (selectedIndex === correctIndex) {
                // إجابة صحيحة
                buttons[selectedIndex].classList.add('correct');
                
                // اختيار مجموعة عشوائية للتقدم
                const randomTeam = Math.floor(Math.random() * 3);
                teams[randomTeam].score++;
                teams[randomTeam].position = Math.min(teams[randomTeam].position + 20, 100);
                
                // تأثيرات بصرية للنجاح
                addSparkleEffect(document.querySelector('.question-card'));
                
                // تحديث العرض
                updateRaceDisplay();
                
                // فحص الفوز
                if (teams[randomTeam].position >= 100) {
                    showWinner(teams[randomTeam].name);
                    return;
                }
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    newQuestion();
                }, 2000);
                
            } else {
                // إجابة خاطئة
                buttons[selectedIndex].classList.add('wrong');
                buttons[correctIndex].classList.add('correct');
                
                // إظهار التلميح
                showHint(hint);
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    newQuestion();
                }, 3000);
            }
        }

        function showHint(hintText) {
            const hintArea = document.getElementById('raceHint');
            const hintTooltip = document.getElementById('hintTooltip');
            hintTooltip.textContent = hintText;
            hintArea.classList.add('show');
            
            // تأثير اهتزاز
            document.querySelector('.question-card').classList.add('shake');
            setTimeout(() => {
                document.querySelector('.question-card').classList.remove('shake');
            }, 500);
        }

        function updateRaceDisplay() {
            teams.forEach((team, index) => {
                const runner = document.getElementById(`team${index + 1}Runner`);
                const score = document.getElementById(`team${index + 1}Score`);
                
                runner.style.left = `${team.position}%`;
                score.textContent = `${team.score}/5`;
                
                // تحديث المرحلة الحالية
                const stageIndex = Math.floor(team.position / 20);
                updateStageDisplay(stageIndex);
            });
        }

        function updateStageDisplay(stageIndex) {
            // إزالة التأثير من جميع المراحل
            document.querySelectorAll('.stage').forEach(stage => {
                stage.classList.remove('active');
            });
            
            // إضافة التأثير للمرحلة الحالية
            if (stageIndex < 5) {
                document.querySelector(`[data-stage="${stageIndex}"]`).classList.add('active');
                document.getElementById('currentStage').textContent = `المرحلة الحالية: ${stages[stageIndex]}`;
            }
        }

        function showWinner(teamName) {
            document.getElementById('winnerText').textContent = `🏆 تهانينا ${teamName}!`;
            document.getElementById('resultsArea').style.display = 'block';
            
            // تأثيرات الفوز
            addSparkleEffect(document.getElementById('resultsArea'));
            
            // إخفاء منطقة الأسئلة
            document.querySelector('.question-area').style.display = 'none';
        }

        function resetRace() {
            // إعادة تعيين البيانات
            teams = [];
            currentQuestionIndex = 0;
            currentStage = 0;
            
            // إعادة تعيين الواجهة
            document.getElementById('teamsSetup').style.display = 'block';
            document.getElementById('raceArea').style.display = 'none';
            document.getElementById('resultsArea').style.display = 'none';
            document.querySelector('.question-area').style.display = 'block';
            
            // إعادة تعيين النماذج
            document.getElementById('team1Name').value = 'المجموعة الأولى';
            document.getElementById('team2Name').value = 'المجموعة الثانية';
            document.getElementById('team3Name').value = 'المجموعة الثالثة';
            
            // إعادة تعيين مواضع العدائين
            document.querySelectorAll('.team-runner').forEach(runner => {
                runner.style.left = '0%';
            });
            
            // إعادة تعيين النقاط
            document.querySelectorAll('.team-score').forEach(score => {
                score.textContent = '0/5';
            });
            
            // إعادة تعيين المراحل
            document.querySelectorAll('.stage').forEach(stage => {
                stage.classList.remove('active');
            });
            document.querySelector('[data-stage="0"]').classList.add('active');
            document.getElementById('currentStage').textContent = 'المرحلة الحالية: البدء';
            
            // إخفاء التلميح
            document.getElementById('raceHint').classList.remove('show');
        }

        // وظائف لعبة الكنز المعرفي
        function startTreasureHunt(mode) {
            treasureMode = mode;
            
            if (mode === 'single') {
                treasureTeams = [{name: 'المغامر', completed: false, time: 0}];
                initializeTreasureGame();
            } else if (mode === 'teams') {
                document.getElementById('treasureTeamsSetup').style.display = 'block';
            }
        }

        function startTeamsTreasureHunt() {
            const team1Name = document.getElementById('treasureTeam1').value || 'قراصنة المعرفة';
            const team2Name = document.getElementById('treasureTeam2').value || 'صيادو الكنوز';
            const team3Name = document.getElementById('treasureTeam3').value || 'محاربو الإدارة';
            
            treasureTeams = [
                {name: team1Name, completed: false, time: 0},
                {name: team2Name, completed: false, time: 0},
                {name: team3Name, completed: false, time: 0}
            ];
            
            initializeTreasureGame();
        }

        function initializeTreasureGame() {
            // إخفاء الإعداد وإظهار منطقة اللعبة
            document.getElementById('treasureSetup').style.display = 'none';
            document.getElementById('treasureGameArea').style.display = 'block';
            
            // إعداد المتغيرات
            treasureGameActive = true;
            treasureStartTime = Date.now();
            currentTreasureOrder = [];
            treasureCompletionTimes = [];
            
            // تحديث العرض
            updateTreasureDashboard();
            createTreasureCards();
            createDropZones();
            
            // بدء العداد
            startTreasureTimer();
        }

        function updateTreasureDashboard() {
            // تحديث العنوان
            document.getElementById('treasureGameTitle').textContent = 
                treasureMode === 'single' ? '🧭 مغامرة الكنز الفردية' : '⚔️ معركة الفرق للكنز';
            
            // تحديث حالة الفرق
            const teamsStatus = document.getElementById('treasureTeamsStatus');
            teamsStatus.innerHTML = '';
            
            if (treasureMode === 'teams') {
                treasureTeams.forEach(team => {
                    const teamStatus = document.createElement('div');
                    teamStatus.className = 'treasure-team-status';
                    teamStatus.innerHTML = `
                        <div class="treasure-team-name">${team.name}</div>
                        <div class="treasure-team-progress">${team.completed ? '✅ مكتمل' : '🔍 يبحث'}</div>
                    `;
                    teamsStatus.appendChild(teamStatus);
                });
            }
        }

        function createTreasureCards() {
            const scatteredCards = document.getElementById('scatteredCards');
            scatteredCards.innerHTML = '';
            
            // خلط البطاقات
            const shuffledCards = [...correctOrder].sort(() => Math.random() - 0.5);
            
            shuffledCards.forEach((cardText, index) => {
                const card = document.createElement('div');
                card.className = 'treasure-card';
                card.textContent = cardText;
                card.draggable = true;
                card.dataset.stage = cardText;
                
                // إضافة أيقونات للمراحل
                const icons = {
                    'البدء': '🚀',
                    'التخطيط': '📋',
                    'التنفيذ': '⚙️',
                    'المراقبة والتحكم': '📊',
                    'الإنهاء': '🏆'
                };
                
                card.innerHTML = `${icons[cardText]} ${cardText}`;
                
                // إضافة أحداث السحب والإفلات
                card.addEventListener('dragstart', handleDragStart);
                card.addEventListener('dragend', handleDragEnd);
                
                // إضافة تأثير تأخير للظهور
                card.style.animationDelay = `${index * 0.1}s`;
                card.style.animation = 'slideIn 0.5s ease forwards';
                
                scatteredCards.appendChild(card);
            });
        }

        function createDropZones() {
            const dropZones = document.getElementById('dropZones');
            dropZones.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone';
                dropZone.dataset.position = i;
                
                const label = document.createElement('div');
                label.className = 'drop-zone-label';
                label.textContent = `المرحلة ${i + 1}`;
                dropZone.appendChild(label);
                
                // إضافة أحداث الإفلات
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('drop', handleDrop);
                dropZone.addEventListener('dragleave', handleDragLeave);
                
                dropZones.appendChild(dropZone);
            }
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.stage);
            e.target.classList.add('dragging');
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.currentTarget;
            const draggedStage = e.dataTransfer.getData('text/plain');
            const position = parseInt(dropZone.dataset.position);
            
            dropZone.classList.remove('drag-over');
            
            // التحقق من وجود بطاقة في هذا المكان
            if (dropZone.querySelector('.treasure-card')) {
                // إرجاع البطاقة الموجودة للمنطقة المبعثرة
                const existingCard = dropZone.querySelector('.treasure-card');
                document.getElementById('scatteredCards').appendChild(existingCard);
            }
            
            // العثور على البطاقة المسحوبة ونقلها
            const draggedCard = document.querySelector(`[data-stage="${draggedStage}"]`);
            if (draggedCard) {
                dropZone.appendChild(draggedCard);
                dropZone.classList.add('filled');
                
                // تحديث الترتيب الحالي
                currentTreasureOrder[position] = draggedStage;
                
                // تحديث شريط التقدم
                updateTreasureProgress();
                
                // تأثيرات بصرية
                addSparkleEffect(dropZone);
            }
        }

        function updateTreasureProgress() {
            const filledSlots = currentTreasureOrder.filter(slot => slot).length;
            const progress = (filledSlots / 5) * 100;
            document.getElementById('treasureProgressFill').style.width = `${progress}%`;
        }

        function checkTreasureOrder() {
            if (!treasureGameActive) return;
            
            // التحقق من اكتمال جميع المواضع
            if (currentTreasureOrder.filter(slot => slot).length < 5) {
                showTreasureMessage('⚠️ يجب ملء جميع المواضع أولاً!', 'warning');
                return;
            }
            
            let correctCount = 0;
            const dropZones = document.querySelectorAll('.drop-zone');
            
            // فحص كل موضع
            dropZones.forEach((zone, index) => {
                zone.classList.remove('correct', 'wrong');
                
                if (currentTreasureOrder[index] === correctOrder[index]) {
                    zone.classList.add('correct');
                    correctCount++;
                } else {
                    zone.classList.add('wrong');
                }
            });
            
            if (correctCount === 5) {
                // تم اكتشاف الكنز!
                treasureGameActive = false;
                clearInterval(treasureTimer);
                
                const completionTime = Date.now() - treasureStartTime;
                treasureCompletionTimes.push({
                    team: treasureMode === 'single' ? 'المغامر' : 'الفريق الحالي',
                    time: completionTime
                });
                
                showTreasureVictory(completionTime);
            } else {
                showTreasureMessage(`🔍 ${correctCount}/5 مراحل صحيحة. حاول مرة أخرى!`, 'info');
                
                // إزالة التأثيرات بعد ثانيتين
                setTimeout(() => {
                    dropZones.forEach(zone => {
                        zone.classList.remove('correct', 'wrong');
                    });
                }, 2000);
            }
        }

        function showTreasureMessage(message, type) {
            // إنشاء رسالة مؤقتة
            const messageDiv = document.createElement('div');
            messageDiv.className = `treasure-message ${type}`;
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: ${type === 'warning' ? '#fff3cd' : type === 'info' ? '#d1ecf1' : '#d4edda'};
                border: 2px solid ${type === 'warning' ? '#ffc107' : type === 'info' ? '#17a2b8' : '#28a745'};
                color: ${type === 'warning' ? '#856404' : type === 'info' ? '#0c5460' : '#155724'};
                padding: 20px 30px;
                border-radius: 15px;
                font-size: 1.2rem;
                font-weight: 500;
                z-index: 10000;
                animation: messageSlide 0.3s ease;
            `;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        function showTreasureVictory(completionTime) {
            const minutes = Math.floor(completionTime / 60000);
            const seconds = Math.floor((completionTime % 60000) / 1000);
            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // إظهار منطقة النتائج
            document.getElementById('treasureResults').style.display = 'block';
            document.getElementById('treasureFinalTime').textContent = `⏱️ الوقت المستغرق: ${timeString}`;
            
            // تأثيرات الاحتفال
            addSparkleEffect(document.getElementById('treasureResults'));
            
            // إخفاء منطقة اللعبة
            document.querySelector('.scattered-cards-area').style.display = 'none';
            document.querySelector('.sorting-area').style.display = 'none';
            
            // عرض الترتيب إذا كان هناك عدة فرق
            if (treasureMode === 'teams') {
                showTreasureRanking();
            }
        }

        function showTreasureRanking() {
            const ranking = document.getElementById('treasureRanking');
            ranking.innerHTML = '<h5>🏆 ترتيب الفرق:</h5>';
            
            // ترتيب الأوقات
            const sortedTimes = [...treasureCompletionTimes].sort((a, b) => a.time - b.time);
            
            sortedTimes.forEach((entry, index) => {
                const rankingItem = document.createElement('div');
                rankingItem.className = 'ranking-item';
                
                const position = document.createElement('span');
                position.className = `ranking-position ${index === 0 ? 'first' : index === 1 ? 'second' : 'third'}`;
                position.textContent = `${index + 1}`;
                
                const team = document.createElement('span');
                team.className = 'ranking-team';
                team.textContent = entry.team;
                
                const time = document.createElement('span');
                time.className = 'ranking-time';
                const minutes = Math.floor(entry.time / 60000);
                const seconds = Math.floor((entry.time % 60000) / 1000);
                time.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                rankingItem.appendChild(position);
                rankingItem.appendChild(team);
                rankingItem.appendChild(time);
                
                ranking.appendChild(rankingItem);
            });
        }

        function shuffleCards() {
            if (!treasureGameActive) return;
            
            // إرجاع جميع البطاقات للمنطقة المبعثرة
            const allCards = document.querySelectorAll('.treasure-card');
            const scatteredCards = document.getElementById('scatteredCards');
            
            allCards.forEach(card => {
                scatteredCards.appendChild(card);
            });
            
            // إعادة تعيين الترتيب الحالي
            currentTreasureOrder = [];
            
            // إزالة تأثيرات المناطق
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('filled', 'correct', 'wrong');
            });
            
            // تحديث شريط التقدم
            updateTreasureProgress();
            
            // تأثير بصري
            addSparkleEffect(scatteredCards);
        }

        function resetTreasureGame() {
            // إعادة تعيين المتغيرات
            treasureMode = '';
            treasureTeams = [];
            treasureStartTime = null;
            currentTreasureOrder = [];
            treasureGameActive = false;
            treasureCompletionTimes = [];
            
            // إيقاف العداد
            clearInterval(treasureTimer);
            
            // إعادة تعيين الواجهة
            document.getElementById('treasureSetup').style.display = 'block';
            document.getElementById('treasureGameArea').style.display = 'none';
            document.getElementById('treasureResults').style.display = 'none';
            document.getElementById('treasureTeamsSetup').style.display = 'none';
            
            // إظهار المناطق المخفية
            document.querySelector('.scattered-cards-area').style.display = 'block';
            document.querySelector('.sorting-area').style.display = 'block';
            
            // إعادة تعيين النماذج
            document.getElementById('treasureTeam1').value = 'قراصنة المعرفة';
            document.getElementById('treasureTeam2').value = 'صيادو الكنوز';
            document.getElementById('treasureTeam3').value = 'محاربو الإدارة';
            
            // إعادة تعيين شريط التقدم
            document.getElementById('treasureProgressFill').style.width = '0%';
        }

        function startTreasureTimer() {
            let startTime = Date.now();
            
            treasureTimer = setInterval(() => {
                if (!treasureGameActive) {
                    clearInterval(treasureTimer);
                    return;
                }
                
                const elapsed = Date.now() - startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                
                document.getElementById('treasureTimer').textContent = 
                    `⏱️ ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // وظائف لعبة التحدي السريع
        function startChallenge(mode) {
            challengeMode = mode;
            
            if (mode === 'single') {
                challengeTeams = [{name: 'اللاعب', score: 0}];
                initializeChallenge();
            } else if (mode === 'team') {
                document.getElementById('teamSetupChallenge').style.display = 'block';
            }
        }

        function startTeamChallenge() {
            const team1Name = document.getElementById('challengeTeam1').value || 'الفريق الأول';
            const team2Name = document.getElementById('challengeTeam2').value || 'الفريق الثاني';
            
            challengeTeams = [
                {name: team1Name, score: 0},
                {name: team2Name, score: 0}
            ];
            
            initializeChallenge();
        }

        function initializeChallenge() {
            // إخفاء الإعداد وإظهار منطقة اللعبة
            document.getElementById('challengeSetup').style.display = 'none';
            document.getElementById('challengeArea').style.display = 'block';
            
            // تحضير الأسئلة
            challengeQuestions = [...challengeQuestionBank].sort(() => Math.random() - 0.5).slice(0, 20);
            currentChallengeQuestion = 0;
            gameAnswers = [];
            isGameActive = true;
            
            // تحديث العرض
            updateChallengeScoreboard();
            
            // بدء أول سؤال
            nextChallengeQuestion();
        }

        function updateChallengeScoreboard() {
            const scoresDisplay = document.getElementById('scoresDisplay');
            scoresDisplay.innerHTML = '';
            
            challengeTeams.forEach(team => {
                const playerScore = document.createElement('div');
                playerScore.className = 'player-score';
                playerScore.innerHTML = `
                    <div class="player-name">${team.name}</div>
                    <div class="score-value">${team.score}</div>
                `;
                scoresDisplay.appendChild(playerScore);
            });
        }

        function nextChallengeQuestion() {
            if (!isGameActive) return;
            
            if (currentChallengeQuestion >= challengeQuestions.length) {
                endChallenge();
                return;
            }
            
            const question = challengeQuestions[currentChallengeQuestion];
            
            // تحديث معلومات السؤال
            document.getElementById('questionNumber').textContent = currentChallengeQuestion + 1;
            document.getElementById('questionType').textContent = question.type === 'multiple' ? 'اختيار من متعدد' : 'صح/خطأ';
            document.getElementById('questionCategory').textContent = question.category;
            document.getElementById('questionDifficulty').textContent = question.difficulty;
            document.getElementById('questionDifficulty').className = `question-difficulty ${question.difficulty === 'سهل' ? 'easy' : question.difficulty === 'صعب' ? 'hard' : ''}`;
            
            // عرض السؤال
            document.getElementById('challengeQuestionText').textContent = question.question;
            
            // عرض الإجابات
            const answersContainer = document.getElementById('challengeAnswers');
            answersContainer.innerHTML = '';
            
            if (question.type === 'multiple') {
                question.answers.forEach((answer, index) => {
                    const button = document.createElement('button');
                    button.className = 'answer-challenge-btn';
                    button.textContent = answer;
                    button.onclick = () => selectChallengeAnswer(index);
                    answersContainer.appendChild(button);
                });
            } else {
                // أسئلة صح/خطأ
                const trueBtn = document.createElement('button');
                trueBtn.className = 'answer-challenge-btn true-false true';
                trueBtn.textContent = '✅ صحيح';
                trueBtn.onclick = () => selectChallengeAnswer(true);
                
                const falseBtn = document.createElement('button');
                falseBtn.className = 'answer-challenge-btn true-false false';
                falseBtn.textContent = '❌ خطأ';
                falseBtn.onclick = () => selectChallengeAnswer(false);
                
                answersContainer.appendChild(trueBtn);
                answersContainer.appendChild(falseBtn);
            }
            
            // بدء العداد
            startQuestionTimer();
            
            // تحديث أزرار التحكم
            document.getElementById('nextQuestionBtn').style.display = 'none';
            document.getElementById('skipBtn').style.display = 'inline-block';
        }

        function startQuestionTimer() {
            timeLeft = 30;
            updateTimerDisplay();
            
            gameTimer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 10) {
                    document.getElementById('questionTimer').classList.add('warning');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(gameTimer);
                    skipQuestion();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            document.getElementById('questionTimer').textContent = `⏱️ ${timeLeft}`;
        }

        function selectChallengeAnswer(selectedAnswer) {
            if (!isGameActive) return;
            
            clearInterval(gameTimer);
            
            const question = challengeQuestions[currentChallengeQuestion];
            const isCorrect = selectedAnswer === question.correct;
            
            // تسجيل الإجابة
            gameAnswers.push({
                question: question.question,
                userAnswer: selectedAnswer,
                correctAnswer: question.correct,
                isCorrect: isCorrect,
                explanation: question.explanation,
                timeUsed: 30 - timeLeft
            });
            
            // تعطيل جميع الأزرار
            document.querySelectorAll('.answer-challenge-btn').forEach(btn => {
                btn.disabled = true;
            });
            
            // إظهار النتيجة
            const buttons = document.querySelectorAll('.answer-challenge-btn');
            if (question.type === 'multiple') {
                buttons[selectedAnswer].classList.add(isCorrect ? 'correct' : 'wrong');
                if (!isCorrect) {
                    buttons[question.correct].classList.add('correct');
                }
            } else {
                const selectedBtn = selectedAnswer ? buttons[0] : buttons[1];
                selectedBtn.classList.add(isCorrect ? 'correct' : 'wrong');
                if (!isCorrect) {
                    const correctBtn = question.correct ? buttons[0] : buttons[1];
                    correctBtn.classList.add('correct');
                }
            }
            
            // تحديث النقاط
            if (isCorrect) {
                if (challengeMode === 'single') {
                    challengeTeams[0].score++;
                } else {
                    // في وضع الفرق، نختار فريق عشوائي للحصول على النقطة
                    const randomTeam = Math.floor(Math.random() * challengeTeams.length);
                    challengeTeams[randomTeam].score++;
                }
                
                // تأثيرات النجاح
                addSparkleEffect(document.querySelector('.question-challenge-card'));
            } else {
                // تأثير الخطأ
                document.querySelector('.question-challenge-card').classList.add('shake');
                setTimeout(() => {
                    document.querySelector('.question-challenge-card').classList.remove('shake');
                }, 500);
            }
            
            updateChallengeScoreboard();
            
            // الانتقال للسؤال التالي
            setTimeout(() => {
                currentChallengeQuestion++;
                nextChallengeQuestion();
            }, 2000);
        }

        function skipQuestion() {
            if (!isGameActive) return;
            
            clearInterval(gameTimer);
            
            const question = challengeQuestions[currentChallengeQuestion];
            
            // تسجيل السؤال المتخطى
            gameAnswers.push({
                question: question.question,
                userAnswer: 'متخطى',
                correctAnswer: question.correct,
                isCorrect: false,
                explanation: question.explanation,
                timeUsed: 30
            });
            
            currentChallengeQuestion++;
            nextChallengeQuestion();
        }

        function endChallenge() {
            isGameActive = false;
            clearInterval(gameTimer);
            
            // إخفاء بطاقة السؤال وإظهار النتائج
            document.querySelector('.question-challenge-card').style.display = 'none';
            document.getElementById('challengeResults').style.display = 'block';
            
            // تحديد الفائز
            let winner = challengeTeams[0];
            challengeTeams.forEach(team => {
                if (team.score > winner.score) {
                    winner = team;
                }
            });
            
            // عرض النتائج النهائية
            document.getElementById('finalResultTitle').textContent = 
                challengeMode === 'single' ? 
                `🏆 انتهى التحدي! حصلت على ${winner.score} نقطة` : 
                `🏆 الفائز: ${winner.name}!`;
            
            // عرض النقاط النهائية
            const finalScores = document.getElementById('finalScores');
            finalScores.innerHTML = '<h5>النتائج النهائية:</h5>';
            challengeTeams.forEach(team => {
                const scoreItem = document.createElement('div');
                scoreItem.className = 'final-score-item';
                scoreItem.innerHTML = `
                    <span class="final-score-name">${team.name}</span>
                    <span class="final-score-value">${team.score}/20</span>
                `;
                finalScores.appendChild(scoreItem);
            });
            
            // تحليل الأداء
            const correctAnswers = gameAnswers.filter(a => a.isCorrect).length;
            const averageTime = gameAnswers.reduce((sum, a) => sum + a.timeUsed, 0) / gameAnswers.length;
            
            document.getElementById('performanceAnalysis').innerHTML = `
                <h5>📊 تحليل الأداء:</h5>
                <div class="performance-stats">
                    <div class="performance-stat">
                        <span class="stat-value">${correctAnswers}</span>
                        <span class="stat-label">إجابات صحيحة</span>
                    </div>
                    <div class="performance-stat">
                        <span class="stat-value">${Math.round((correctAnswers/20)*100)}%</span>
                        <span class="stat-label">نسبة النجاح</span>
                    </div>
                    <div class="performance-stat">
                        <span class="stat-value">${Math.round(averageTime)}</span>
                        <span class="stat-label">متوسط الوقت (ثانية)</span>
                    </div>
                </div>
            `;
        }

        function restartChallenge() {
            // إعادة تعيين المتغيرات
            challengeMode = '';
            challengeTeams = [];
            currentChallengeQuestion = 0;
            challengeQuestions = [];
            gameAnswers = [];
            isGameActive = false;
            
            // إعادة تعيين الواجهة
            document.getElementById('challengeSetup').style.display = 'block';
            document.getElementById('challengeArea').style.display = 'none';
            document.getElementById('challengeResults').style.display = 'none';
            document.getElementById('teamSetupChallenge').style.display = 'none';
            document.querySelector('.question-challenge-card').style.display = 'block';
            
            // إعادة تعيين النماذج
            document.getElementById('challengeTeam1').value = 'الفريق الأول';
            document.getElementById('challengeTeam2').value = 'الفريق الثاني';
            
            // إعادة تعيين العداد
            document.getElementById('questionTimer').classList.remove('warning');
            clearInterval(gameTimer);
        }

        function reviewAnswers() {
            document.getElementById('reviewArea').style.display = 'block';
            
            const reviewContent = document.getElementById('reviewContent');
            reviewContent.innerHTML = '';
            
            gameAnswers.forEach((answer, index) => {
                const reviewItem = document.createElement('div');
                reviewItem.className = `review-item ${answer.isCorrect ? 'correct' : 'wrong'}`;
                
                let userAnswerText = '';
                if (answer.userAnswer === 'متخطى') {
                    userAnswerText = 'متخطى';
                } else if (typeof answer.userAnswer === 'boolean') {
                    userAnswerText = answer.userAnswer ? 'صحيح' : 'خطأ';
                } else {
                    const question = challengeQuestions[index];
                    userAnswerText = question.answers ? question.answers[answer.userAnswer] : answer.userAnswer;
                }
                
                let correctAnswerText = '';
                if (typeof answer.correctAnswer === 'boolean') {
                    correctAnswerText = answer.correctAnswer ? 'صحيح' : 'خطأ';
                } else {
                    const question = challengeQuestions[index];
                    correctAnswerText = question.answers ? question.answers[answer.correctAnswer] : answer.correctAnswer;
                }
                
                reviewItem.innerHTML = `
                    <div class="review-question">${answer.question}</div>
                    <div class="review-answer user">إجابتك: ${userAnswerText}</div>
                    <div class="review-answer correct">الإجابة الصحيحة: ${correctAnswerText}</div>
                    <div class="review-answer">${answer.explanation}</div>
                `;
                
                reviewContent.appendChild(reviewItem);
            });
        }

        function closeReview() {
            document.getElementById('reviewArea').style.display = 'none';
        }

        // وظائف لعبة الأدوار
        function startRoleplay(mode) {
            roleplayMode = mode;
            
            if (mode === 'single') {
                roleplayTeams = [{name: 'الممثل', score: 0, votes: 0}];
                initializeRoleplay();
            } else if (mode === 'teams') {
                document.getElementById('roleplayTeamsSetup').style.display = 'block';
            }
        }

        function startTeamsRoleplay() {
            const team1Name = document.getElementById('roleplayTeam1').value || 'مديرو المستقبل';
            const team2Name = document.getElementById('roleplayTeam2').value || 'خبراء الحلول';
            const team3Name = document.getElementById('roleplayTeam3').value || 'محترفو الإدارة';
            
            roleplayTeams = [
                {name: team1Name, score: 0, votes: 0},
                {name: team2Name, score: 0, votes: 0},
                {name: team3Name, score: 0, votes: 0}
            ];
            
            initializeRoleplay();
        }

        function initializeRoleplay() {
            // إخفاء الإعداد وإظهار منطقة اللعبة
            document.getElementById('roleplaySetup').style.display = 'none';
            document.getElementById('roleplayGameArea').style.display = 'block';
            
            // إعداد المتغيرات
            roleplayGameActive = true;
            currentRound = 1;
            roleplayVotes = {};
            selectedVote = null;
            presentationTimers = {};
            
            // تحديث العرض
            updateRoleplayDashboard();
            
            // بدء أول سيناريو
            newScenario();
        }

        function updateRoleplayDashboard() {
            // تحديث العنوان
            document.getElementById('roleplayGameTitle').textContent = 
                roleplayMode === 'single' ? '🎭 العرض الفردي' : '👥 مسابقة الفرق';
            
            // تحديث رقم الجولة
            document.getElementById('roleplayRound').textContent = `الجولة ${currentRound}`;
            
            // تحديث حالة الفرق
            const teamsStatus = document.getElementById('roleplayTeamsStatus');
            teamsStatus.innerHTML = '';
            
            if (roleplayMode === 'teams') {
                roleplayTeams.forEach(team => {
                    const teamStatus = document.createElement('div');
                    teamStatus.className = 'roleplay-team-status';
                    teamStatus.innerHTML = `
                        <div class="roleplay-team-name">${team.name}</div>
                        <div class="roleplay-team-score">النقاط: ${team.score}</div>
                    `;
                    teamsStatus.appendChild(teamStatus);
                });
            }
        }

        function newScenario() {
            if (!roleplayGameActive) return;
            
            // اختيار سيناريو عشوائي
            currentScenario = scenarioBank[Math.floor(Math.random() * scenarioBank.length)];
            
            // عرض السيناريو
            document.getElementById('scenarioTitle').textContent = currentScenario.title;
            document.getElementById('scenarioCategory').textContent = currentScenario.category;
            document.getElementById('scenarioDescription').textContent = currentScenario.description;
            
            // عرض التفاصيل
            const detailsList = document.getElementById('scenarioDetailsList');
            detailsList.innerHTML = '';
            currentScenario.details.forEach(detail => {
                const li = document.createElement('li');
                li.textContent = detail;
                detailsList.appendChild(li);
            });
            
            document.getElementById('scenarioDetails').style.display = 'block';
            
            // عرض التحدي
            document.getElementById('scenarioChallengeText').textContent = currentScenario.challenge;
            document.getElementById('scenarioChallenge').style.display = 'block';
            
            // إعداد منطقة العروض
            if (roleplayMode === 'teams') {
                setupPresentationSlots();
                document.getElementById('teamsPresentation').style.display = 'block';
            }
            
            // إخفاء منطقة التصويت والنتائج
            document.getElementById('votingArea').style.display = 'none';
            document.getElementById('roleplayResults').style.display = 'none';
            
            // إعادة تعيين الأصوات
            roleplayVotes = {};
            selectedVote = null;
            
            // تأثيرات بصرية
            addSparkleEffect(document.querySelector('.scenario-area'));
        }

        function setupPresentationSlots() {
            const presentationSlots = document.getElementById('presentationSlots');
            presentationSlots.innerHTML = '';
            
            roleplayTeams.forEach((team, index) => {
                const slot = document.createElement('div');
                slot.className = 'presentation-slot';
                slot.id = `presentationSlot${index}`;
                
                slot.innerHTML = `
                    <div class="slot-header">
                        <div class="team-presenter">${team.name}</div>
                        <div class="presentation-timer" id="timer${index}">⏱️ 3:00</div>
                    </div>
                    <div class="presentation-content">
                        <textarea class="presentation-textarea" id="presentation${index}" 
                                  placeholder="اكتب حلك هنا... فكر كمدير مشروع محترف واعرض خطة عمل شاملة"></textarea>
                    </div>
                    <div class="presentation-controls">
                        <button onclick="startPresentation(${index})" class="start-presentation-btn" id="startBtn${index}">
                            🎬 بدء العرض
                        </button>
                        <button onclick="finishPresentation(${index})" class="finish-presentation-btn" id="finishBtn${index}" style="display: none;">
                            ✅ إنهاء العرض
                        </button>
                    </div>
                `;
                
                presentationSlots.appendChild(slot);
            });
        }

        function startPresentation(teamIndex) {
            const slot = document.getElementById(`presentationSlot${teamIndex}`);
            const startBtn = document.getElementById(`startBtn${teamIndex}`);
            const finishBtn = document.getElementById(`finishBtn${teamIndex}`);
            const timerDisplay = document.getElementById(`timer${teamIndex}`);
            
            // تفعيل الفتحة
            slot.classList.add('active');
            
            // إخفاء زر البدء وإظهار زر الإنهاء
            startBtn.style.display = 'none';
            finishBtn.style.display = 'inline-block';
            
            // بدء العداد (3 دقائق)
            let timeLeft = 180; // 3 دقائق بالثواني
            presentationTimers[teamIndex] = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `⏱️ ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 30) {
                    timerDisplay.style.background = '#ff6b6b';
                    timerDisplay.style.animation = 'pulse 1s infinite';
                }
                
                timeLeft--;
                
                if (timeLeft < 0) {
                    finishPresentation(teamIndex);
                }
            }, 1000);
            
            // تأثيرات بصرية
            addSparkleEffect(slot);
        }

        function finishPresentation(teamIndex) {
            const slot = document.getElementById(`presentationSlot${teamIndex}`);
            const startBtn = document.getElementById(`startBtn${teamIndex}`);
            const finishBtn = document.getElementById(`finishBtn${teamIndex}`);
            const timerDisplay = document.getElementById(`timer${teamIndex}`);
            
            // إيقاف العداد
            clearInterval(presentationTimers[teamIndex]);
            
            // إلغاء تفعيل الفتحة
            slot.classList.remove('active');
            
            // إخفاء الأزرار
            startBtn.style.display = 'none';
            finishBtn.style.display = 'none';
            
            // تحديث العداد
            timerDisplay.textContent = '✅ انتهى';
            timerDisplay.style.background = '#28a745';
            timerDisplay.style.animation = 'none';
            
            // التحقق من انتهاء جميع العروض
            checkAllPresentationsFinished();
        }

        function checkAllPresentationsFinished() {
            const allFinished = roleplayTeams.every((team, index) => {
                const finishBtn = document.getElementById(`finishBtn${index}`);
                return finishBtn.style.display === 'none';
            });
            
            if (allFinished) {
                // إظهار منطقة التصويت
                setTimeout(() => {
                    setupVoting();
                    document.getElementById('votingArea').style.display = 'block';
                    addSparkleEffect(document.getElementById('votingArea'));
                }, 1000);
            }
        }

        function setupVoting() {
            const votingOptions = document.getElementById('votingOptions');
            votingOptions.innerHTML = '';
            
            roleplayTeams.forEach((team, index) => {
                const option = document.createElement('div');
                option.className = 'voting-option';
                option.dataset.teamIndex = index;
                option.onclick = () => selectVotingOption(index);
                
                option.innerHTML = `
                    <span class="option-team">${team.name}</span>
                    <span class="option-votes" id="votes${index}">0</span>
                `;
                
                votingOptions.appendChild(option);
            });
            
            // إعادة تعيين أزرار التحكم
            document.getElementById('castVoteBtn').style.display = 'inline-block';
            document.getElementById('showResultsBtn').style.display = 'none';
        }

        function selectVotingOption(teamIndex) {
            // إزالة التحديد من جميع الخيارات
            document.querySelectorAll('.voting-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // تحديد الخيار الحالي
            const selectedOption = document.querySelector(`[data-team-index="${teamIndex}"]`);
            selectedOption.classList.add('selected');
            
            selectedVote = teamIndex;
            
            // تأثيرات بصرية
            addSparkleEffect(selectedOption);
        }

        function castVote() {
            if (selectedVote === null) {
                showRoleplayMessage('⚠️ يرجى اختيار فريق للتصويت له أولاً!', 'warning');
                return;
            }
            
            // تسجيل الصوت
            if (!roleplayVotes[selectedVote]) {
                roleplayVotes[selectedVote] = 0;
            }
            roleplayVotes[selectedVote]++;
            
            // تحديث عرض الأصوات
            document.getElementById(`votes${selectedVote}`).textContent = roleplayVotes[selectedVote];
            
            // إخفاء زر التصويت وإظهار زر النتائج
            document.getElementById('castVoteBtn').style.display = 'none';
            document.getElementById('showResultsBtn').style.display = 'inline-block';
            
            // تأثيرات بصرية
            const selectedOption = document.querySelector(`[data-team-index="${selectedVote}"]`);
            addGlowEffect(selectedOption);
            
            showRoleplayMessage('✅ تم تسجيل صوتك بنجاح!', 'success');
        }

        function showRoleplayResults() {
            // حساب النتائج
            const results = roleplayTeams.map((team, index) => ({
                team: team.name,
                votes: roleplayVotes[index] || 0,
                index: index
            })).sort((a, b) => b.votes - a.votes);
            
            // تحديث نقاط الفرق
            results.forEach((result, position) => {
                const points = position === 0 ? 3 : position === 1 ? 2 : 1;
                roleplayTeams[result.index].score += points;
                roleplayTeams[result.index].votes += result.votes;
            });
            
            // عرض المنصة
            const winnerPodium = document.getElementById('winnerPodium');
            winnerPodium.innerHTML = '';
            
            results.slice(0, 3).forEach((result, position) => {
                const podiumPlace = document.createElement('div');
                podiumPlace.className = `podium-place ${position === 0 ? 'first' : position === 1 ? 'second' : 'third'}`;
                
                const positionEmojis = ['🥇', '🥈', '🥉'];
                
                podiumPlace.innerHTML = `
                    <div class="podium-position">${positionEmojis[position]}</div>
                    <div class="podium-team">${result.team}</div>
                    <div class="podium-votes">${result.votes} أصوات</div>
                `;
                
                winnerPodium.appendChild(podiumPlace);
            });
            
            // تحديث النص
            document.getElementById('roleplayWinnerText').textContent = 
                `🏆 الفائز في الجولة ${currentRound}: ${results[0].team}!`;
            
            // إظهار النتائج
            document.getElementById('roleplayResults').style.display = 'block';
            
            // إخفاء منطقة التصويت
            document.getElementById('votingArea').style.display = 'none';
            
            // تحديث لوحة المعلومات
            updateRoleplayDashboard();
            
            // تأثيرات الاحتفال
            addSparkleEffect(document.getElementById('roleplayResults'));
        }

        function showRoleplayMessage(message, type) {
            // إنشاء رسالة مؤقتة
            const messageDiv = document.createElement('div');
            messageDiv.className = `roleplay-message ${type}`;
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: ${type === 'warning' ? '#fff3cd' : type === 'success' ? '#d4edda' : '#d1ecf1'};
                border: 2px solid ${type === 'warning' ? '#ffc107' : type === 'success' ? '#28a745' : '#17a2b8'};
                color: ${type === 'warning' ? '#856404' : type === 'success' ? '#155724' : '#0c5460'};
                padding: 20px 30px;
                border-radius: 15px;
                font-size: 1.2rem;
                font-weight: 500;
                z-index: 10000;
                animation: messageSlide 0.3s ease;
            `;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        function resetRoleplay() {
            // إعادة تعيين المتغيرات
            roleplayMode = '';
            roleplayTeams = [];
            currentScenario = null;
            currentRound = 1;
            roleplayVotes = {};
            selectedVote = null;
            presentationTimers = {};
            roleplayGameActive = false;
            
            // إيقاف جميع العدادات
            Object.values(presentationTimers).forEach(timer => {
                clearInterval(timer);
            });
            
            // إعادة تعيين الواجهة
            document.getElementById('roleplaySetup').style.display = 'block';
            document.getElementById('roleplayGameArea').style.display = 'none';
            document.getElementById('roleplayTeamsSetup').style.display = 'none';
            document.getElementById('teamsPresentation').style.display = 'none';
            document.getElementById('votingArea').style.display = 'none';
            document.getElementById('roleplayResults').style.display = 'none';
            
            // إعادة تعيين النماذج
            document.getElementById('roleplayTeam1').value = 'مديرو المستقبل';
            document.getElementById('roleplayTeam2').value = 'خبراء الحلول';
            document.getElementById('roleplayTeam3').value = 'محترفو الإدارة';
            
            // إخفاء تفاصيل السيناريو
            document.getElementById('scenarioDetails').style.display = 'none';
            document.getElementById('scenarioChallenge').style.display = 'none';
            document.getElementById('scenarioDescription').textContent = 'انقر على "سيناريو جديد" لبدء التمثيل';
        }

        // وظائف لعبة بناء المشروع
        function startProjectBuilder(mode) {
            builderMode = mode;
            
            if (mode === 'single') {
                builderTeams = [{name: 'المهندس', completed: false, time: 0}];
                initializeProjectBuilder();
            } else if (mode === 'teams') {
                document.getElementById('builderTeamsSetup').style.display = 'block';
            }
        }

        function startTeamsProjectBuilder() {
            const team1Name = document.getElementById('builderTeam1').value || 'مهندسو المستقبل';
            const team2Name = document.getElementById('builderTeam2').value || 'بناة النجاح';
            const team3Name = document.getElementById('builderTeam3').value || 'خبراء الإدارة';
            
            builderTeams = [
                {name: team1Name, completed: false, time: 0},
                {name: team2Name, completed: false, time: 0},
                {name: team3Name, completed: false, time: 0}
            ];
            
            initializeProjectBuilder();
        }

        function initializeProjectBuilder() {
            // إخفاء الإعداد وإظهار منطقة اللعبة
            document.getElementById('builderSetup').style.display = 'none';
            document.getElementById('builderGameArea').style.display = 'block';
            
            // إعداد المتغيرات
            builderGameActive = true;
            builderStartTime = Date.now();
            currentBuildOrder = [];
            builderCompletionTimes = [];
            
            // تحديث العرض
            updateBuilderDashboard();
            createProjectComponents();
            createFoundationLayers();
            
            // بدء العداد
            startBuilderTimer();
        }

        function updateBuilderDashboard() {
            // تحديث العنوان
            document.getElementById('builderGameTitle').textContent = 
                builderMode === 'single' ? '🧑‍💼 ورشة البناء الفردية' : '👥 سباق فرق البناء';
            
            // تحديث حالة الفرق
            const teamsStatus = document.getElementById('builderTeamsStatus');
            teamsStatus.innerHTML = '';
            
            if (builderMode === 'teams') {
                builderTeams.forEach(team => {
                    const teamStatus = document.createElement('div');
                    teamStatus.className = 'builder-team-status';
                    teamStatus.innerHTML = `
                        <div class="builder-team-name">${team.name}</div>
                        <div class="builder-team-progress">${team.completed ? '✅ مكتمل' : '🏗️ يبني'}</div>
                    `;
                    teamsStatus.appendChild(teamStatus);
                });
            }
        }

        function createProjectComponents() {
            const componentsContainer = document.getElementById('projectComponents');
            componentsContainer.innerHTML = '';
            
            // خلط القطع
            const shuffledPieces = [...projectPieces].sort(() => Math.random() - 0.5);
            
            shuffledPieces.forEach((piece, index) => {
                const component = document.createElement('div');
                component.className = 'project-component';
                component.dataset.componentId = piece.id;
                component.draggable = true;
                
                component.innerHTML = `
                    <div class="component-icon">${piece.icon}</div>
                    <div class="component-name">${piece.name}</div>
                    <div class="component-description">${piece.description}</div>
                `;
                
                // إضافة أحداث السحب والإفلات
                component.addEventListener('dragstart', handleComponentDragStart);
                component.addEventListener('dragend', handleComponentDragEnd);
                component.addEventListener('click', selectComponent);
                
                // إضافة تأثير تأخير للظهور
                component.style.animationDelay = `${index * 0.1}s`;
                component.style.animation = 'slideIn 0.5s ease forwards';
                
                componentsContainer.appendChild(component);
            });
        }

        function createFoundationLayers() {
            const foundationLayers = document.getElementById('foundationLayers');
            foundationLayers.innerHTML = '';
            
            const layerNames = [
                'الأساس - القيادة',
                'الطبقة الأولى - التحديد',
                'الطبقة الثانية - التخطيط',
                'الطبقة الثالثة - الفريق',
                'الطبقة الرابعة - الموارد',
                'الطبقة الخامسة - التوقيت',
                'الطبقة العليا - الميزانية'
            ];
            
            for (let i = 0; i < 7; i++) {
                const layer = document.createElement('div');
                layer.className = 'foundation-layer';
                layer.dataset.layerIndex = i;
                
                const label = document.createElement('div');
                label.className = 'layer-label';
                label.textContent = layerNames[i];
                layer.appendChild(label);
                
                // إضافة أحداث الإفلات
                layer.addEventListener('dragover', handleLayerDragOver);
                layer.addEventListener('drop', handleLayerDrop);
                layer.addEventListener('dragleave', handleLayerDragLeave);
                
                foundationLayers.appendChild(layer);
            }
        }

        function handleComponentDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.componentId);
            e.target.classList.add('dragging');
        }

        function handleComponentDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function selectComponent(e) {
            // إزالة التحديد من جميع القطع
            document.querySelectorAll('.project-component').forEach(comp => {
                comp.classList.remove('selected');
            });
            
            // تحديد القطعة الحالية
            e.currentTarget.classList.add('selected');
            
            // تأثيرات بصرية
            addSparkleEffect(e.currentTarget);
        }

        function handleLayerDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleLayerDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleLayerDrop(e) {
            e.preventDefault();
            const layer = e.currentTarget;
            const componentId = e.dataTransfer.getData('text/plain');
            const layerIndex = parseInt(layer.dataset.layerIndex);
            
            layer.classList.remove('drag-over');
            
            // التحقق من وجود قطعة في هذه الطبقة
            if (layer.querySelector('.project-component')) {
                // إرجاع القطعة الموجودة للمنطقة الأصلية
                const existingComponent = layer.querySelector('.project-component');
                document.getElementById('projectComponents').appendChild(existingComponent);
            }
            
            // العثور على القطعة المسحوبة ونقلها
            const draggedComponent = document.querySelector(`[data-component-id="${componentId}"]`);
            if (draggedComponent) {
                layer.appendChild(draggedComponent);
                layer.classList.add('filled');
                
                // تحديث الترتيب الحالي
                currentBuildOrder[layerIndex] = componentId;
                
                // تحديث شريط التقدم
                updateBuilderProgress();
                
                // تأثيرات بصرية
                addSparkleEffect(layer);
            }
        }

        function updateBuilderProgress() {
            const filledLayers = currentBuildOrder.filter(layer => layer).length;
            const progress = (filledLayers / 7) * 100;
            document.getElementById('builderProgressFill').style.width = `${progress}%`;
        }

        function checkProjectBuild() {
            if (!builderGameActive) return;
            
            // التحقق من اكتمال جميع الطبقات
            if (currentBuildOrder.filter(layer => layer).length < 7) {
                showBuilderMessage('⚠️ يجب ملء جميع طبقات الأساس أولاً!', 'warning');
                return;
            }
            
            let correctCount = 0;
            const foundationLayers = document.querySelectorAll('.foundation-layer');
            
            // فحص كل طبقة
            foundationLayers.forEach((layer, index) => {
                layer.classList.remove('correct', 'wrong');
                
                if (currentBuildOrder[index] === correctBuildOrder[index]) {
                    layer.classList.add('correct');
                    correctCount++;
                } else {
                    layer.classList.add('wrong');
                }
            });
            
            if (correctCount === 7) {
                // تم إكمال البناء بنجاح!
                builderGameActive = false;
                clearInterval(builderTimer);
                
                const completionTime = Date.now() - builderStartTime;
                builderCompletionTimes.push({
                    team: builderMode === 'single' ? 'المهندس' : 'الفريق الحالي',
                    time: completionTime
                });
                
                showBuilderVictory(completionTime);
            } else {
                showBuilderMessage(`🏗️ ${correctCount}/7 قطع في المكان الصحيح. راجع البناء!`, 'info');
                
                // إزالة التأثيرات بعد ثانيتين
                setTimeout(() => {
                    foundationLayers.forEach(layer => {
                        layer.classList.remove('correct', 'wrong');
                    });
                }, 2000);
            }
        }

        function showBuilderMessage(message, type) {
            // إنشاء رسالة مؤقتة
            const messageDiv = document.createElement('div');
            messageDiv.className = `builder-message ${type}`;
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: ${type === 'warning' ? '#fff3cd' : type === 'info' ? '#d1ecf1' : '#d4edda'};
                border: 2px solid ${type === 'warning' ? '#ffc107' : type === 'info' ? '#17a2b8' : '#28a745'};
                color: ${type === 'warning' ? '#856404' : type === 'info' ? '#0c5460' : '#155724'};
                padding: 20px 30px;
                border-radius: 15px;
                font-size: 1.2rem;
                font-weight: 500;
                z-index: 10000;
                animation: messageSlide 0.3s ease;
            `;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        function showBuilderVictory(completionTime) {
            const minutes = Math.floor(completionTime / 60000);
            const seconds = Math.floor((completionTime % 60000) / 1000);
            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // إظهار منطقة النتائج
            document.getElementById('builderResults').style.display = 'block';
            document.getElementById('builderFinalTime').textContent = `⏱️ وقت الإكمال: ${timeString}`;
            
            // تأثيرات الاحتفال
            addSparkleEffect(document.getElementById('builderResults'));
            
            // إخفاء منطقة اللعبة
            document.querySelector('.components-area').style.display = 'none';
            document.querySelector('.building-area').style.display = 'none';
            
            // عرض الترتيب إذا كان هناك عدة فرق
            if (builderMode === 'teams') {
                showBuilderRanking();
            }
        }

        function showBuilderRanking() {
            const ranking = document.getElementById('builderRanking');
            ranking.innerHTML = '<h5>🏆 ترتيب فرق البناء:</h5>';
            
            // ترتيب الأوقات
            const sortedTimes = [...builderCompletionTimes].sort((a, b) => a.time - b.time);
            
            sortedTimes.forEach((entry, index) => {
                const rankingItem = document.createElement('div');
                rankingItem.className = 'ranking-item';
                
                const position = document.createElement('span');
                position.className = `ranking-position ${index === 0 ? 'first' : index === 1 ? 'second' : 'third'}`;
                position.textContent = `${index + 1}`;
                
                const team = document.createElement('span');
                team.className = 'ranking-team';
                team.textContent = entry.team;
                
                const time = document.createElement('span');
                time.className = 'ranking-time';
                const minutes = Math.floor(entry.time / 60000);
                const seconds = Math.floor((entry.time % 60000) / 1000);
                time.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                rankingItem.appendChild(position);
                rankingItem.appendChild(team);
                rankingItem.appendChild(time);
                
                ranking.appendChild(rankingItem);
            });
        }

        function shuffleComponents() {
            if (!builderGameActive) return;
            
            // إرجاع جميع القطع للمنطقة الأصلية
            const allComponents = document.querySelectorAll('.project-component');
            const componentsContainer = document.getElementById('projectComponents');
            
            allComponents.forEach(component => {
                componentsContainer.appendChild(component);
            });
            
            // إعادة تعيين الترتيب الحالي
            currentBuildOrder = [];
            
            // إزالة تأثيرات الطبقات
            document.querySelectorAll('.foundation-layer').forEach(layer => {
                layer.classList.remove('filled', 'correct', 'wrong');
            });
            
            // تحديث شريط التقدم
            updateBuilderProgress();
            
            // تأثير بصري
            addSparkleEffect(componentsContainer);
        }

        function resetProjectBuilder() {
            // إعادة تعيين المتغيرات
            builderMode = '';
            builderTeams = [];
            builderStartTime = null;
            currentBuildOrder = [];
            builderGameActive = false;
            builderCompletionTimes = [];
            
            // إيقاف العداد
            clearInterval(builderTimer);
            
            // إعادة تعيين الواجهة
            document.getElementById('builderSetup').style.display = 'block';
            document.getElementById('builderGameArea').style.display = 'none';
            document.getElementById('builderResults').style.display = 'none';
            document.getElementById('builderTeamsSetup').style.display = 'none';
            
            // إظهار المناطق المخفية
            document.querySelector('.components-area').style.display = 'block';
            document.querySelector('.building-area').style.display = 'block';
            
            // إعادة تعيين النماذج
            document.getElementById('builderTeam1').value = 'مهندسو المستقبل';
            document.getElementById('builderTeam2').value = 'بناة النجاح';
            document.getElementById('builderTeam3').value = 'خبراء الإدارة';
            
            // إعادة تعيين شريط التقدم
            document.getElementById('builderProgressFill').style.width = '0%';
        }

        function startBuilderTimer() {
            let startTime = Date.now();
            
            builderTimer = setInterval(() => {
                if (!builderGameActive) {
                    clearInterval(builderTimer);
                    return;
                }
                
                const elapsed = Date.now() - startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                
                document.getElementById('builderTimer').textContent = 
                    `⏱️ ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // وظائف التأثيرات البصرية
        function addSparkleEffect(element) {
            element.classList.add('sparkle');
            setTimeout(() => element.classList.remove('sparkle'), 2000);
        }
        
        function addGlowEffect(element) {
            element.classList.add('glow');
            setTimeout(() => element.classList.remove('glow'), 3000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9abba5a233ffcdf8',t:'MTc2NTM1ODIyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
